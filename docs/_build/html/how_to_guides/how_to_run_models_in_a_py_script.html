<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>How to run models in a Python script &mdash; WaterTAP 1.2.dev0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=d1d7ad24"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="next" title="How to run a zero-order model" href="how_to_run_zero_order_model.html" />
    <link rel="prev" title="How To Guides" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            WaterTAP
              <img src="../_static/NAWI_logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                1.2.dev0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">How To Guides</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">How to run models in a Python script</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#example-python-file-with-recommended-structure">Example: Python file with recommended structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-the-same-code-without-recommended-structure-may-cause-errors-on-windows">Example: the same code without recommended structure (may cause errors on Windows)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="how_to_run_zero_order_model.html">How to run a zero-order model</a></li>
<li class="toctree-l2"><a class="reference internal" href="how_to_use_a_property_model.html">How to use a property model</a></li>
<li class="toctree-l2"><a class="reference internal" href="how_to_setup_simple_RO.html">How to setup a simple RO model</a></li>
<li class="toctree-l2"><a class="reference internal" href="how_to_setup_RO_config_options.html">How to use configuration options in the RO model</a></li>
<li class="toctree-l2"><a class="reference internal" href="how_to_use_MCAS_property_model.html">How to use the multicomponent aqueous solution (MCAS) property model</a></li>
<li class="toctree-l2"><a class="reference internal" href="how_to_setup_simple_chemistry.html">How to setup simple chemistry</a></li>
<li class="toctree-l2"><a class="reference internal" href="how_to_use_apparent_and_true_chemical_species.html">How to use apparent and true chemical species</a></li>
<li class="toctree-l2"><a class="reference internal" href="how_to_use_inherent_reactions.html">How to use inherent reactions</a></li>
<li class="toctree-l2"><a class="reference internal" href="how_to_scale_a_model.html">How to scale a model</a></li>
<li class="toctree-l2"><a class="reference internal" href="how_to_scale_chemical_reactions.html">How to scale chemical reactions</a></li>
<li class="toctree-l2"><a class="reference internal" href="how_to_scale_chemical_species.html">How to scale chemical species</a></li>
<li class="toctree-l2"><a class="reference internal" href="how_to_scale_chemical_process_energy_balance.html">How to scale energy balance for chemical process</a></li>
<li class="toctree-l2"><a class="reference internal" href="how_to_use_parameter_sweep.html">How to explore a model with parameter sweep</a></li>
<li class="toctree-l2"><a class="reference internal" href="how_to_use_parameter_sweep_monte_carlo.html">Monte Carlo testing with the Parameter Sweep</a></li>
<li class="toctree-l2"><a class="reference internal" href="how_to_run_differential_parameter_sweep.html">How to Run Differential Parameter Sweep</a></li>
<li class="toctree-l2"><a class="reference internal" href="how_to_use_loopTool_to_explore_flowsheets.html">How to use loopTool to explore flowsheets</a></li>
<li class="toctree-l2"><a class="reference internal" href="how_to_use_debugging_solver_wrapper.html">How to use the debugging solver wrapper</a></li>
<li class="toctree-l2"><a class="reference internal" href="how_to_use_property_test_harness.html">How to use the property test harness</a></li>
<li class="toctree-l2"><a class="reference internal" href="how_to_use_ui_api.html">Add a flowsheet to the UI</a></li>
<li class="toctree-l2"><a class="reference internal" href="how_to_use_ui_api.html#testing-flowsheet-interfaces">Testing flowsheet interfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="how_to_use_unit_test_harness.html">How to use the unit test harness</a></li>
<li class="toctree-l2"><a class="reference internal" href="how_to_contribute_development.html">How to contribute to WaterTAP’s development</a></li>
<li class="toctree-l2"><a class="reference internal" href="notebooks.html">How to run WaterTAP with Jupyter notebooks</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../technical_reference/index.html">Technical Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../background/index.html">Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License Agreement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../copyright.html">Copyright</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">WaterTAP</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">How To Guides</a></li>
      <li class="breadcrumb-item active">How to run models in a Python script</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/how_to_guides/how_to_run_models_in_a_py_script.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="how-to-run-models-in-a-python-script">
<span id="how-to-run-models-in-a-py-script"></span><h1>How to run models in a Python script<a class="headerlink" href="#how-to-run-models-in-a-python-script" title="Permalink to this heading"></a></h1>
<p>In most circumstances, code involving WaterTAP models should run without issues in any way Python code can normally be run (assuming that the <a class="reference internal" href="../getting_started.html#install"><span class="std std-ref">installation procedure</span></a> has been completed successfully).</p>
<p>However, when writing a script, it is recommended (and in some cases, required; see below for details) to structure the script in the following way:</p>
<ol class="arabic">
<li><p>Start from an empty Python source file, e.g. <code class="docutils literal notranslate"><span class="pre">run_my_model.py</span></code></p></li>
<li><p>At the beginning of the file, in the <strong>global scope</strong>, define the imports for external modules (and, if applicable, other externally defined objects).
In this context, defining something at the global scope means that it is written at the leftmost level of the Python file, i.e. without any indentation.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyomo.environ</span> <span class="k">as</span> <span class="nn">pyo</span>
<span class="kn">import</span> <span class="nn">idaes</span>
<span class="kn">from</span> <span class="nn">pyomo.contrib.pynumero.interfaces.pyomo_nlp</span> <span class="kn">import</span> <span class="n">PyomoNLP</span>
</pre></div>
</div>
</li>
<li><p>Next, also in the global scope, add any constants, functions, and/or classes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">my_function</span><span class="p">():</span>
    <span class="k">return</span> <span class="mi">42</span>


<span class="n">MY_CONSTANT</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
</li>
<li><p>Next, define a function (typically called <code class="docutils literal notranslate"><span class="pre">main()</span></code>), where all other code (creating a model, variable, model initialization, solve, …) will be defined.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>

    <span class="n">m</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">ConcreteModel</span><span class="p">()</span>
    <span class="n">m</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">()</span>
    <span class="n">m</span><span class="o">.</span><span class="n">c</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">m</span><span class="o">.</span><span class="n">o</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Objective</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>

    <span class="n">nlp</span> <span class="o">=</span> <span class="n">PyomoNLP</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>At the end of the file, add the following code snippet. This will cause the <code class="docutils literal notranslate"><span class="pre">main()</span></code> function to be called only when the Python file is invoked directly:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p>Finally, save and run the Python file:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>run_my_model.py
</pre></div>
</div>
</li>
</ol>
<section id="example-python-file-with-recommended-structure">
<h2>Example: Python file with recommended structure<a class="headerlink" href="#example-python-file-with-recommended-structure" title="Permalink to this heading"></a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import concrete model from Pyomo</span>
<span class="kn">from</span> <span class="nn">pyomo.environ</span> <span class="kn">import</span> <span class="n">ConcreteModel</span>
<span class="c1"># Import flowsheet block from IDAES core</span>
<span class="kn">from</span> <span class="nn">idaes.core</span> <span class="kn">import</span> <span class="n">FlowsheetBlock</span>
<span class="c1"># Import NaCl property model</span>
<span class="kn">import</span> <span class="nn">watertap.property_models.NaCl_prop_pack</span> <span class="k">as</span> <span class="nn">props</span>
<span class="c1"># Import utility tool for calculating scaling factors</span>
<span class="kn">from</span> <span class="nn">idaes.core.util.scaling</span> <span class="kn">import</span> <span class="n">calculate_scaling_factors</span>
<span class="c1"># Import RO model</span>
<span class="kn">from</span> <span class="nn">watertap.unit_models.reverse_osmosis_0D</span> <span class="kn">import</span> <span class="n">ReverseOsmosis0D</span>
<span class="c1"># import the solver</span>
<span class="kn">from</span> <span class="nn">watertap.core.solvers</span> <span class="kn">import</span> <span class="n">get_solver</span>


<span class="c1"># Put all the model constructors, initialization, and solver in a separate function</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="c1"># Create a concrete model, flowsheet, and NaCl property parameter block.</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">ConcreteModel</span><span class="p">()</span>
    <span class="n">m</span><span class="o">.</span><span class="n">fs</span> <span class="o">=</span> <span class="n">FlowsheetBlock</span><span class="p">(</span><span class="n">dynamic</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">properties</span> <span class="o">=</span> <span class="n">props</span><span class="o">.</span><span class="n">NaClParameterBlock</span><span class="p">()</span>
    <span class="c1"># Add an RO unit to the flowsheet.</span>
    <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">ReverseOsmosis0D</span><span class="p">(</span><span class="n">property_package</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">properties</span><span class="p">)</span>

    <span class="c1"># Specify system variables.</span>
    <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">inlet</span><span class="o">.</span><span class="n">flow_mass_phase_comp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Liq&#39;</span><span class="p">,</span> <span class="s1">&#39;NaCl&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mf">0.035</span><span class="p">)</span>  <span class="c1"># mass flow rate of NaCl</span>
    <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">inlet</span><span class="o">.</span><span class="n">flow_mass_phase_comp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Liq&#39;</span><span class="p">,</span> <span class="s1">&#39;H2O&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mf">0.965</span><span class="p">)</span>  <span class="c1"># mass flow rate of water</span>
    <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">inlet</span><span class="o">.</span><span class="n">pressure</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mf">50e5</span><span class="p">)</span>  <span class="c1"># feed pressure</span>
    <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">inlet</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mf">298.15</span><span class="p">)</span>  <span class="c1"># feed temperature</span>
    <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">area</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>  <span class="c1"># membrane area</span>
    <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">A_comp</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mf">4.2e-12</span><span class="p">)</span>  <span class="c1"># membrane water permeability</span>
    <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">B_comp</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mf">3.5e-8</span><span class="p">)</span>  <span class="c1"># membrane salt permeability</span>
    <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">permeate</span><span class="o">.</span><span class="n">pressure</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mi">101325</span><span class="p">)</span>  <span class="c1"># permeate pressure</span>

    <span class="c1"># Set scaling factors for component mass flowrates.</span>
    <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">set_default_scaling</span><span class="p">(</span><span class="s1">&#39;flow_mass_phase_comp&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Liq&#39;</span><span class="p">,</span> <span class="s1">&#39;H2O&#39;</span><span class="p">))</span>
    <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">set_default_scaling</span><span class="p">(</span><span class="s1">&#39;flow_mass_phase_comp&#39;</span><span class="p">,</span> <span class="mf">1e2</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Liq&#39;</span><span class="p">,</span> <span class="s1">&#39;NaCl&#39;</span><span class="p">))</span>

    <span class="c1"># Calculate scaling factors.</span>
    <span class="n">calculate_scaling_factors</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>

    <span class="c1"># Get default watertap solver</span>
    <span class="n">solver</span> <span class="o">=</span> <span class="n">get_solver</span><span class="p">()</span>

    <span class="c1"># Initialize the model passing default solver options</span>
    <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="n">optarg</span><span class="o">=</span><span class="n">solver</span><span class="o">.</span><span class="n">options</span><span class="p">)</span>

    <span class="c1"># Solve the model (using the tee=True option to display solver info)</span>
    <span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">tee</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="c1"># Call that function in the &quot;__main__&quot; for the script</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="example-the-same-code-without-recommended-structure-may-cause-errors-on-windows">
<h2>Example: the same code without recommended structure (may cause errors on Windows)<a class="headerlink" href="#example-the-same-code-without-recommended-structure-may-cause-errors-on-windows" title="Permalink to this heading"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import concrete model from Pyomo</span>
<span class="kn">from</span> <span class="nn">pyomo.environ</span> <span class="kn">import</span> <span class="n">ConcreteModel</span>
<span class="c1"># Import flowsheet block from IDAES core</span>
<span class="kn">from</span> <span class="nn">idaes.core</span> <span class="kn">import</span> <span class="n">FlowsheetBlock</span>
<span class="c1"># Import NaCl property model</span>
<span class="kn">import</span> <span class="nn">watertap.property_models.NaCl_prop_pack</span> <span class="k">as</span> <span class="nn">props</span>
<span class="c1"># Import utility tool for calculating scaling factors</span>
<span class="kn">from</span> <span class="nn">idaes.core.util.scaling</span> <span class="kn">import</span> <span class="n">calculate_scaling_factors</span>
<span class="c1"># Import RO model</span>
<span class="kn">from</span> <span class="nn">watertap.unit_models.reverse_osmosis_0D</span> <span class="kn">import</span> <span class="n">ReverseOsmosis0D</span>
<span class="c1"># import the solver</span>
<span class="kn">from</span> <span class="nn">watertap.core.solvers</span> <span class="kn">import</span> <span class="n">get_solver</span>

<span class="c1"># Create a concrete model, flowsheet, and NaCl property parameter block.</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">ConcreteModel</span><span class="p">()</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span> <span class="o">=</span> <span class="n">FlowsheetBlock</span><span class="p">(</span><span class="n">dynamic</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">properties</span> <span class="o">=</span> <span class="n">props</span><span class="o">.</span><span class="n">NaClParameterBlock</span><span class="p">()</span>
<span class="c1"># Add an RO unit to the flowsheet.</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">ReverseOsmosis0D</span><span class="p">(</span><span class="n">property_package</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">properties</span><span class="p">)</span>

<span class="c1"># Specify system variables.</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">inlet</span><span class="o">.</span><span class="n">flow_mass_phase_comp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Liq&#39;</span><span class="p">,</span> <span class="s1">&#39;NaCl&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mf">0.035</span><span class="p">)</span>  <span class="c1"># mass flow rate of NaCl</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">inlet</span><span class="o">.</span><span class="n">flow_mass_phase_comp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Liq&#39;</span><span class="p">,</span> <span class="s1">&#39;H2O&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mf">0.965</span><span class="p">)</span>  <span class="c1"># mass flow rate of water</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">inlet</span><span class="o">.</span><span class="n">pressure</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mf">50e5</span><span class="p">)</span>  <span class="c1"># feed pressure</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">inlet</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mf">298.15</span><span class="p">)</span>  <span class="c1"># feed temperature</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">area</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>  <span class="c1"># membrane area</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">A_comp</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mf">4.2e-12</span><span class="p">)</span>  <span class="c1"># membrane water permeability</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">B_comp</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mf">3.5e-8</span><span class="p">)</span>  <span class="c1"># membrane salt permeability</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">permeate</span><span class="o">.</span><span class="n">pressure</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mi">101325</span><span class="p">)</span>  <span class="c1"># permeate pressure</span>

<span class="c1"># Set scaling factors for component mass flowrates.</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">set_default_scaling</span><span class="p">(</span><span class="s1">&#39;flow_mass_phase_comp&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Liq&#39;</span><span class="p">,</span> <span class="s1">&#39;H2O&#39;</span><span class="p">))</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">set_default_scaling</span><span class="p">(</span><span class="s1">&#39;flow_mass_phase_comp&#39;</span><span class="p">,</span> <span class="mf">1e2</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Liq&#39;</span><span class="p">,</span> <span class="s1">&#39;NaCl&#39;</span><span class="p">))</span>

<span class="c1"># Calculate scaling factors.</span>
<span class="n">calculate_scaling_factors</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>

<span class="c1"># Get default watertap solver</span>
<span class="n">solver</span> <span class="o">=</span> <span class="n">get_solver</span><span class="p">()</span>

<span class="c1"># Initialize the model passing default solver options</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="n">optarg</span><span class="o">=</span><span class="n">solver</span><span class="o">.</span><span class="n">options</span><span class="p">)</span>

<span class="c1"># Solve the model (using the tee=True option to display solver info)</span>
<span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">tee</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>If code other than imports and constant/function/class definitions is run in the global scope (i.e. not defined inside a function), it is likely to cause errors when run on Windows.
See <a class="reference external" href="https://github.com/watertap-org/watertap/issues/387">issue #387</a> for more details.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="How To Guides" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="how_to_run_zero_order_model.html" class="btn btn-neutral float-right" title="How to run a zero-order model" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; <a href="../copyright.html">Copyright</a> 2020-2024, NAWI.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>