<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>watertap.property_models.unit_specific.anaerobic_digestion.modified_adm1_reactions &mdash; WaterTAP 1.2.dev0 documentation</title>
      <link rel="stylesheet" href="../../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../../../_static/custom.css" type="text/css" />
    <link rel="shortcut icon" href="../../../../../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="../../../../../" id="documentation_options" src="../../../../../_static/documentation_options.js?v=d1d7ad24"></script>
        <script src="../../../../../_static/doctools.js?v=888ff710"></script>
        <script src="../../../../../_static/sphinx_highlight.js?v=4825356b"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" />
    <link rel="copyright" title="Copyright" href="../../../../../copyright.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../../index.html" class="icon icon-home">
            WaterTAP
              <img src="../../../../../_static/NAWI_logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                1.2.dev0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../how_to_guides/index.html">How To Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../technical_reference/index.html">Technical Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../background/index.html">Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../license.html">License Agreement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../copyright.html">Copyright</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../index.html">WaterTAP</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">watertap.property_models.unit_specific.anaerobic_digestion.modified_adm1_reactions</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for watertap.property_models.unit_specific.anaerobic_digestion.modified_adm1_reactions</h1><div class="highlight"><pre>
<span></span><span class="c1">#################################################################################</span>
<span class="c1"># WaterTAP Copyright (c) 2020-2024, The Regents of the University of California,</span>
<span class="c1"># through Lawrence Berkeley National Laboratory, Oak Ridge National Laboratory,</span>
<span class="c1"># National Renewable Energy Laboratory, and National Energy Technology</span>
<span class="c1"># Laboratory (subject to receipt of any required approvals from the U.S. Dept.</span>
<span class="c1"># of Energy). All rights reserved.</span>
<span class="c1">#</span>
<span class="c1"># Please see the files COPYRIGHT.md and LICENSE.md for full copyright and license</span>
<span class="c1"># information, respectively. These files are also available online at the URL</span>
<span class="c1"># &quot;https://github.com/watertap-org/watertap/&quot;</span>
<span class="c1">#################################################################################</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Modified ADM1 reaction package.</span>

<span class="sd">Reference:</span>

<span class="sd">X. Flores-Alsina, K. Solon, C.K. Mbamba, S. Tait, K.V. Gernaey, U. Jeppsson, D.J. Batstone,</span>
<span class="sd">Modelling phosphorus (P), sulfur (S) and iron (Fe) interactions fordynamic simulations of anaerobic digestion processes,</span>
<span class="sd">Water Research. 95 (2016) 370-382. https://www.sciencedirect.com/science/article/pii/S0043135416301397</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="c1"># Import Pyomo libraries</span>
<span class="kn">import</span> <span class="nn">pyomo.environ</span> <span class="k">as</span> <span class="nn">pyo</span>
<span class="kn">from</span> <span class="nn">pyomo.environ</span> <span class="kn">import</span> <span class="n">Suffix</span>

<span class="c1"># Import IDAES cores</span>
<span class="kn">from</span> <span class="nn">idaes.core</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">declare_process_block_class</span><span class="p">,</span>
    <span class="n">MaterialFlowBasis</span><span class="p">,</span>
    <span class="n">ReactionParameterBlock</span><span class="p">,</span>
    <span class="n">ReactionBlockDataBase</span><span class="p">,</span>
    <span class="n">ReactionBlockBase</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">idaes.core.util.constants</span> <span class="kn">import</span> <span class="n">Constants</span>
<span class="kn">from</span> <span class="nn">idaes.core.util.misc</span> <span class="kn">import</span> <span class="n">add_object_reference</span>
<span class="kn">from</span> <span class="nn">idaes.core.util.exceptions</span> <span class="kn">import</span> <span class="n">BurntToast</span>
<span class="kn">import</span> <span class="nn">idaes.logger</span> <span class="k">as</span> <span class="nn">idaeslog</span>
<span class="kn">import</span> <span class="nn">idaes.core.util.scaling</span> <span class="k">as</span> <span class="nn">iscale</span>
<span class="kn">from</span> <span class="nn">idaes.core.util.math</span> <span class="kn">import</span> <span class="n">smooth_max</span>

<span class="c1"># Some more information about this module</span>
<span class="n">__author__</span> <span class="o">=</span> <span class="s2">&quot;Chenyu Wang, Marcus Holly, Xinhong Liu&quot;</span>

<span class="c1"># Set up logger</span>
<span class="n">_log</span> <span class="o">=</span> <span class="n">idaeslog</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="n">mw_n</span> <span class="o">=</span> <span class="mi">14</span> <span class="o">*</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kmol</span>
<span class="n">mw_c</span> <span class="o">=</span> <span class="mi">12</span> <span class="o">*</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kmol</span>
<span class="n">mw_p</span> <span class="o">=</span> <span class="mi">31</span> <span class="o">*</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kmol</span>


<div class="viewcode-block" id="ModifiedADM1ReactionParameterData"><a class="viewcode-back" href="../../../../../technical_reference/property_models/modified_ADM1.html#watertap.property_models.unit_specific.anaerobic_digestion.modified_adm1_reactions.ModifiedADM1ReactionParameterData">[docs]</a><span class="nd">@declare_process_block_class</span><span class="p">(</span><span class="s2">&quot;ModifiedADM1ReactionParameterBlock&quot;</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">ModifiedADM1ReactionParameterData</span><span class="p">(</span><span class="n">ReactionParameterBlock</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Property Parameter Block Class</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="ModifiedADM1ReactionParameterData.build"><a class="viewcode-back" href="../../../../../technical_reference/property_models/modified_ADM1.html#watertap.property_models.unit_specific.anaerobic_digestion.modified_adm1_reactions.ModifiedADM1ReactionParameterData.build">[docs]</a>    <span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Callable method for Block construction.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">scaling_factor</span> <span class="o">=</span> <span class="n">Suffix</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="n">Suffix</span><span class="o">.</span><span class="n">EXPORT</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_reaction_block_class</span> <span class="o">=</span> <span class="n">ModifiedADM1ReactionBlock</span>

        <span class="c1"># Reaction Index</span>
        <span class="c1"># Reaction names based on standard numbering in ADM1</span>
        <span class="c1"># R1:  Hydrolysis of carbohydrates</span>
        <span class="c1"># R2:  Hydrolysis of proteins</span>
        <span class="c1"># R3:  Hydrolysis of lipids</span>
        <span class="c1"># R4:  Uptake of sugars</span>
        <span class="c1"># R5:  Uptake of amino acids</span>
        <span class="c1"># R6:  Uptake of long chain fatty acids (LCFAs)</span>
        <span class="c1"># R7:  Uptake of valerate</span>
        <span class="c1"># R8:  Uptake of butyrate</span>
        <span class="c1"># R9:  Uptake of propionate</span>
        <span class="c1"># R10: Uptake of acetate</span>
        <span class="c1"># R11: Uptake of hydrogen</span>
        <span class="c1"># R12: Decay of X_su</span>
        <span class="c1"># R13: Decay of X_aa</span>
        <span class="c1"># R14: Decay of X_fa</span>
        <span class="c1"># R15: Decay of X_c4</span>
        <span class="c1"># R16: Decay of X_pro</span>
        <span class="c1"># R17: Decay of X_ac</span>
        <span class="c1"># R18: Decay of X_h2</span>
        <span class="c1"># R19: Storage of S_va in X_PHA</span>
        <span class="c1"># R20: Storage of S_bu in X_PHA</span>
        <span class="c1"># R21: Storage of S_pro in X_PHA</span>
        <span class="c1"># R22: Storage of S_ac in X_PHA</span>
        <span class="c1"># R23: Lysis of X_PAO</span>
        <span class="c1"># R24: Lysis of X_PP</span>
        <span class="c1"># R25: Lysis of X_PHA</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">rate_reaction_idx</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Set</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="p">[</span>
                <span class="s2">&quot;R1&quot;</span><span class="p">,</span>
                <span class="s2">&quot;R2&quot;</span><span class="p">,</span>
                <span class="s2">&quot;R3&quot;</span><span class="p">,</span>
                <span class="s2">&quot;R4&quot;</span><span class="p">,</span>
                <span class="s2">&quot;R5&quot;</span><span class="p">,</span>
                <span class="s2">&quot;R6&quot;</span><span class="p">,</span>
                <span class="s2">&quot;R7&quot;</span><span class="p">,</span>
                <span class="s2">&quot;R8&quot;</span><span class="p">,</span>
                <span class="s2">&quot;R9&quot;</span><span class="p">,</span>
                <span class="s2">&quot;R10&quot;</span><span class="p">,</span>
                <span class="s2">&quot;R11&quot;</span><span class="p">,</span>
                <span class="s2">&quot;R12&quot;</span><span class="p">,</span>
                <span class="s2">&quot;R13&quot;</span><span class="p">,</span>
                <span class="s2">&quot;R14&quot;</span><span class="p">,</span>
                <span class="s2">&quot;R15&quot;</span><span class="p">,</span>
                <span class="s2">&quot;R16&quot;</span><span class="p">,</span>
                <span class="s2">&quot;R17&quot;</span><span class="p">,</span>
                <span class="s2">&quot;R18&quot;</span><span class="p">,</span>
                <span class="s2">&quot;R19&quot;</span><span class="p">,</span>
                <span class="s2">&quot;R20&quot;</span><span class="p">,</span>
                <span class="s2">&quot;R21&quot;</span><span class="p">,</span>
                <span class="s2">&quot;R22&quot;</span><span class="p">,</span>
                <span class="s2">&quot;R23&quot;</span><span class="p">,</span>
                <span class="s2">&quot;R24&quot;</span><span class="p">,</span>
                <span class="s2">&quot;R25&quot;</span><span class="p">,</span>
            <span class="p">]</span>
        <span class="p">)</span>

        <span class="c1"># Carbon content</span>
        <span class="n">Ci_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;S_su&quot;</span><span class="p">:</span> <span class="mf">0.031250000</span><span class="p">,</span>
            <span class="s2">&quot;S_aa&quot;</span><span class="p">:</span> <span class="mf">0.030741549</span><span class="p">,</span>
            <span class="s2">&quot;S_fa&quot;</span><span class="p">:</span> <span class="mf">0.021404110</span><span class="p">,</span>
            <span class="s2">&quot;S_va&quot;</span><span class="p">:</span> <span class="mf">0.024038462</span><span class="p">,</span>
            <span class="s2">&quot;S_bu&quot;</span><span class="p">:</span> <span class="mf">0.02500000</span><span class="p">,</span>
            <span class="s2">&quot;S_pro&quot;</span><span class="p">:</span> <span class="mf">0.026785714</span><span class="p">,</span>
            <span class="s2">&quot;S_ac&quot;</span><span class="p">:</span> <span class="mf">0.0312500000</span><span class="p">,</span>
            <span class="s2">&quot;S_ch4&quot;</span><span class="p">:</span> <span class="mf">0.015625000</span><span class="p">,</span>
            <span class="s2">&quot;S_I&quot;</span><span class="p">:</span> <span class="mf">0.030148202</span><span class="p">,</span>
            <span class="s2">&quot;X_ch&quot;</span><span class="p">:</span> <span class="mf">0.031250000</span><span class="p">,</span>
            <span class="s2">&quot;X_pr&quot;</span><span class="p">:</span> <span class="mf">0.030741549</span><span class="p">,</span>
            <span class="s2">&quot;X_li&quot;</span><span class="p">:</span> <span class="mf">0.021925591</span><span class="p">,</span>
            <span class="s2">&quot;X_su&quot;</span><span class="p">:</span> <span class="mf">0.030509792</span><span class="p">,</span>
            <span class="s2">&quot;X_aa&quot;</span><span class="p">:</span> <span class="mf">0.030509792</span><span class="p">,</span>
            <span class="s2">&quot;X_fa&quot;</span><span class="p">:</span> <span class="mf">0.030509792</span><span class="p">,</span>
            <span class="s2">&quot;X_c4&quot;</span><span class="p">:</span> <span class="mf">0.030509792</span><span class="p">,</span>
            <span class="s2">&quot;X_pro&quot;</span><span class="p">:</span> <span class="mf">0.030509792</span><span class="p">,</span>
            <span class="s2">&quot;X_ac&quot;</span><span class="p">:</span> <span class="mf">0.030509792</span><span class="p">,</span>
            <span class="s2">&quot;X_h2&quot;</span><span class="p">:</span> <span class="mf">0.030509792</span><span class="p">,</span>
            <span class="s2">&quot;X_I&quot;</span><span class="p">:</span> <span class="mf">0.030148202</span><span class="p">,</span>
            <span class="s2">&quot;X_PHA&quot;</span><span class="p">:</span> <span class="mf">0.02500000</span><span class="p">,</span>
            <span class="s2">&quot;X_PAO&quot;</span><span class="p">:</span> <span class="mf">0.030509792</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">Ci_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span>
            <span class="n">initialize</span><span class="o">=</span><span class="n">Ci_dict</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kmol</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Carbon content of component [kmole C/kg COD]&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Nitrogen content</span>
        <span class="n">Ni_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;S_aa&quot;</span><span class="p">:</span> <span class="mf">0.0079034</span><span class="p">,</span>
            <span class="s2">&quot;S_I&quot;</span><span class="p">:</span> <span class="mf">0.0042876</span><span class="p">,</span>
            <span class="s2">&quot;X_pr&quot;</span><span class="p">:</span> <span class="mf">0.0079034</span><span class="p">,</span>
            <span class="s2">&quot;X_su&quot;</span><span class="p">:</span> <span class="mf">0.0061532</span><span class="p">,</span>
            <span class="s2">&quot;X_aa&quot;</span><span class="p">:</span> <span class="mf">0.0061532</span><span class="p">,</span>
            <span class="s2">&quot;X_fa&quot;</span><span class="p">:</span> <span class="mf">0.0061532</span><span class="p">,</span>
            <span class="s2">&quot;X_c4&quot;</span><span class="p">:</span> <span class="mf">0.0061532</span><span class="p">,</span>
            <span class="s2">&quot;X_pro&quot;</span><span class="p">:</span> <span class="mf">0.0061532</span><span class="p">,</span>
            <span class="s2">&quot;X_ac&quot;</span><span class="p">:</span> <span class="mf">0.0061532</span><span class="p">,</span>
            <span class="s2">&quot;X_h2&quot;</span><span class="p">:</span> <span class="mf">0.0061532</span><span class="p">,</span>
            <span class="s2">&quot;X_I&quot;</span><span class="p">:</span> <span class="mf">0.0042876</span><span class="p">,</span>
            <span class="s2">&quot;X_PAO&quot;</span><span class="p">:</span> <span class="mf">0.0061532</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Ni</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">Ni_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span>
            <span class="n">initialize</span><span class="o">=</span><span class="n">Ni_dict</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kmol</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Nitrogen content of component [kmole N/kg COD]&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Phosphorus content</span>
        <span class="n">Pi_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;S_I&quot;</span><span class="p">:</span> <span class="mf">0.0002093322</span><span class="p">,</span>
            <span class="s2">&quot;X_li&quot;</span><span class="p">:</span> <span class="mf">0.0003440808</span><span class="p">,</span>
            <span class="s2">&quot;X_su&quot;</span><span class="p">:</span> <span class="mf">0.0006947201</span><span class="p">,</span>
            <span class="s2">&quot;X_aa&quot;</span><span class="p">:</span> <span class="mf">0.0006947201</span><span class="p">,</span>
            <span class="s2">&quot;X_fa&quot;</span><span class="p">:</span> <span class="mf">0.0006947201</span><span class="p">,</span>
            <span class="s2">&quot;X_c4&quot;</span><span class="p">:</span> <span class="mf">0.0006947201</span><span class="p">,</span>
            <span class="s2">&quot;X_pro&quot;</span><span class="p">:</span> <span class="mf">0.0006947201</span><span class="p">,</span>
            <span class="s2">&quot;X_ac&quot;</span><span class="p">:</span> <span class="mf">0.0006947201</span><span class="p">,</span>
            <span class="s2">&quot;X_h2&quot;</span><span class="p">:</span> <span class="mf">0.0006947201</span><span class="p">,</span>
            <span class="s2">&quot;X_I&quot;</span><span class="p">:</span> <span class="mf">0.0002093322</span><span class="p">,</span>
            <span class="s2">&quot;X_PP&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;X_PAO&quot;</span><span class="p">:</span> <span class="mf">0.0006947201</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Pi</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">Pi_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span>
            <span class="n">initialize</span><span class="o">=</span><span class="n">Pi_dict</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kmol</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Phosphorus content of component [kmole P/kg COD]&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Common parameters for both translator blocks</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">f_sI_xc</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Param</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">dimensionless</span><span class="p">,</span>
            <span class="n">mutable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Soluble inerts from composites&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">f_xI_xc</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Param</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">dimensionless</span><span class="p">,</span>
            <span class="n">mutable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Particulate inerts from composites&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">f_ch_xc</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Param</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">0.275</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">dimensionless</span><span class="p">,</span>
            <span class="n">mutable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Carbohydrates from composites&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">f_pr_xc</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Param</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">0.275</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">dimensionless</span><span class="p">,</span>
            <span class="n">mutable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Proteins from composites&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">f_li_xc</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Param</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">0.35</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">dimensionless</span><span class="p">,</span>
            <span class="n">mutable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Lipids from composites&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">P_ch</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Param</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kmol</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span><span class="p">,</span>
            <span class="n">mutable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;P content of X_ch&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># TODO: Consider inheriting these parameters from ADM1 such that there is less repeated code</span>

        <span class="c1"># Stoichiometric Parameters (Table 1.1 and 2.1 in Flores-Alsina et al., 2016)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Z_h2s</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Param</span><span class="p">(</span>
            <span class="n">within</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">NonNegativeReals</span><span class="p">,</span>
            <span class="n">mutable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Reference component mass concentration of hydrogen sulfide&quot;</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">f_xi_xb</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">dimensionless</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Fraction of inert particulate organics from biomass&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">f_ch_xb</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">0.275</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">dimensionless</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Fraction of carbohydrates from biomass&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">f_li_xb</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">0.350</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">dimensionless</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Fraction of lipids from biomass&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">f_pr_xb</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">0.275</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">dimensionless</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Fraction of proteins from biomass&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">f_si_xb</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">dimensionless</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">NonNegativeReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Fraction of soluble inerts from biomass&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">f_fa_li</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">dimensionless</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Fatty acids from lipids&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">f_h2_su</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">0.1906</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">dimensionless</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Hydrogen from sugars&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">f_bu_su</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">0.1328</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">dimensionless</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Butyrate from sugars&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">f_pro_su</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">0.2691</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">dimensionless</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Propionate from sugars&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">f_ac_su</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">0.4076</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">dimensionless</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Acetate from sugars&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">f_h2_aa</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">0.06</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">dimensionless</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Hydrogen from amino acids&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">f_va_aa</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">0.23</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">dimensionless</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Valerate from amino acids&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">f_bu_aa</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">0.26</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">dimensionless</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Butyrate from amino acids&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">f_pro_aa</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">dimensionless</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Propionate from amino acids&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">f_ac_aa</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">0.40</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">dimensionless</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Acetate from amino acids&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Y_su</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">0.10</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">dimensionless</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Yield of biomass on sugar substrate [kg COD X/ kg COD S]&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Y_aa</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">0.08</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">dimensionless</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Yield of biomass on amino acid substrate [kg COD X/ kg COD S]&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Y_fa</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">0.06</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">dimensionless</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Yield of biomass on fatty acid substrate [kg COD X/ kg COD S]&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Y_c4</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">0.06</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">dimensionless</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Yield of biomass on valerate and butyrate substrate [kg COD X/ kg COD S]&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Y_pro</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">0.04</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">dimensionless</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Yield of biomass on propionate substrate [kg COD X/ kg COD S]&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Y_ac</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">dimensionless</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Yield of biomass on acetate substrate [kg COD X/ kg COD S]&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Y_h2</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">0.06</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">dimensionless</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Yield of hydrogen per biomass [kg COD S/ kg COD X]&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="c1"># Biochemical Parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k_hyd_ch</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">day</span><span class="o">**-</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;First-order kinetic parameter for hydrolysis of carbohydrates&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k_hyd_pr</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">day</span><span class="o">**-</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;First-order kinetic parameter for hydrolysis of proteins&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k_hyd_li</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">day</span><span class="o">**-</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;First-order kinetic parameter for hydrolysis of lipids&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">K_S_IN</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kmol</span> <span class="o">*</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**-</span><span class="mi">3</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Inhibition parameter for inorganic nitrogen&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k_m_su</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">day</span><span class="o">**-</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Monod maximum specific uptake rate of sugars&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">K_S_su</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">*</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**-</span><span class="mi">3</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Half saturation value for uptake of sugars&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pH_UL_aa</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">5.5</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">dimensionless</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Upper limit of pH for uptake rate of amino acids&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pH_LL_aa</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">dimensionless</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Lower limit of pH for uptake rate of amino acids&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k_m_aa</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">day</span><span class="o">**-</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Monod maximum specific uptake rate of amino acids&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">K_S_aa</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">*</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**-</span><span class="mi">3</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Half saturation value for uptake of amino acids&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k_m_fa</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">day</span><span class="o">**-</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Monod maximum specific uptake rate of fatty acids&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">K_S_fa</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">*</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**-</span><span class="mi">3</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Half saturation value for uptake of fatty acids&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">K_I_h2_fa</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">5e-6</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">*</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**-</span><span class="mi">3</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Inhibition parameter for hydrogen during uptake of fatty acids&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k_m_c4</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">day</span><span class="o">**-</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Monod maximum specific uptake rate of valerate and butyrate&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">K_S_c4</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">*</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**-</span><span class="mi">3</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Half saturation value for uptake of valerate and butyrate&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">K_I_h2_c4</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">*</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**-</span><span class="mi">3</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Inhibition parameter for hydrogen during uptake of valerate and butyrate&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k_m_pro</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">day</span><span class="o">**-</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Monod maximum specific uptake rate of propionate&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">K_S_pro</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">*</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**-</span><span class="mi">3</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Half saturation value for uptake of propionate&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">K_I_h2_pro</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">3.5e-6</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">*</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**-</span><span class="mi">3</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Inhibition parameter for hydrogen during uptake of propionate&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k_m_ac</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">day</span><span class="o">**-</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Monod maximum specific uptake rate of acetate&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">K_S_ac</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">*</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**-</span><span class="mi">3</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Half saturation value for uptake of acetate&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">K_I_nh3</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">0.0018</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kmol</span> <span class="o">*</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**-</span><span class="mi">3</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Inhibition parameter for ammonia during uptake of acetate&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pH_UL_ac</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">dimensionless</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Upper limit of pH for uptake rate of acetate&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pH_LL_ac</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">dimensionless</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Lower limit of pH for uptake rate of acetate&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k_m_h2</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mi">35</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">day</span><span class="o">**-</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Monod maximum specific uptake rate of hydrogen&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">K_S_h2</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">7e-6</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">*</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**-</span><span class="mi">3</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Half saturation value for uptake of hydrogen&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pH_UL_h2</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">dimensionless</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Upper limit of pH for uptake rate of hydrogen&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pH_LL_h2</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">dimensionless</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Lower limit of pH for uptake rate of hydrogen&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k_dec_X_su</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">day</span><span class="o">**-</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;First-order decay rate for X_su&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k_dec_X_aa</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">day</span><span class="o">**-</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;First-order decay rate for X_aa&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k_dec_X_fa</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">day</span><span class="o">**-</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;First-order decay rate for X_fa&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k_dec_X_c4</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">day</span><span class="o">**-</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;First-order decay rate for X_c4&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k_dec_X_pro</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">day</span><span class="o">**-</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;First-order decay rate for X_pro&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k_dec_X_ac</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">day</span><span class="o">**-</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;First-order decay rate for X_ac&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k_dec_X_h2</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">day</span><span class="o">**-</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;First-order decay rate for X_h2&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">K_a_va</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mf">4.86</span><span class="p">),</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kmol</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Valerate acid-base equilibrium constant&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">K_a_bu</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mf">4.82</span><span class="p">),</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kmol</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Butyrate acid-base equilibrium constant&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">K_a_pro</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mf">4.88</span><span class="p">),</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kmol</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Propionate acid-base equilibrium constant&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">K_a_ac</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mf">4.76</span><span class="p">),</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kmol</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Acetate acid-base equilibrium constant&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">K_I_h2s_ac</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">460e-3</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;50</span><span class="si">% i</span><span class="s2">nhibitory concentration of H2S on acetogens&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">K_I_h2s_c4</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">481e-3</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;50</span><span class="si">% i</span><span class="s2">nhibitory concentration of H2S on c4 degraders&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">K_I_h2s_h2</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">400e-3</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;50</span><span class="si">% i</span><span class="s2">nhibitory concentration of H2S on hydrogenotrophic methanogens&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">K_I_h2s_pro</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">481e-3</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;50</span><span class="si">% i</span><span class="s2">nhibitory concentration of propionate degraders&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">K_S_IP</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">2e-5</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kmol</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;P limitation for inorganic phosphorus&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b_PAO</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">day</span><span class="o">**-</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Lysis rate of phosphorus accumulating organisms&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b_PHA</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">day</span><span class="o">**-</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Lysis rate of polyhydroxyalkanoates&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b_PP</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">day</span><span class="o">**-</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Lysis rate of polyphosphates&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">f_ac_PHA</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">dimensionless</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Yield of acetate on polyhydroxyalkanoates&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">f_bu_PHA</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">dimensionless</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Yield of butyrate on polyhydroxyalkanoates&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">f_pro_PHA</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">dimensionless</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Yield of propionate on polyhydroxyalkanoates&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">f_va_PHA</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">dimensionless</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Yield of valerate on polyhydroxyalkanoates&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">K_A</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">4e-3</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">*</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**-</span><span class="mi">3</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Saturation coefficient for acetate&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">K_PP</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">0.32e-3</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">dimensionless</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Saturation coefficient for polyphosphate&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">q_PHA</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">day</span><span class="o">**-</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Rate constant for storage of polyhydroxyalkanoates&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Y_PO4</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">12.903e-3</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">dimensionless</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Yield of biomass on phosphate (kmol P/kg COD)&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">K_XPP</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">3</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">dimensionless</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Potassium coefficient for polyphosphates&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Mg_XPP</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">3</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">dimensionless</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Magnesium coefficient for polyphosphates&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">temperature_ref</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Param</span><span class="p">(</span>
            <span class="n">within</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">mutable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="mf">298.15</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Reference temperature&quot;</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">K</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Reaction Stoichiometry</span>
        <span class="c1"># This is the stoichiometric part of the Peterson matrix in dict form.</span>
        <span class="c1"># See Table 1.1 and 2.1 in Flores-Alsina et al., 2016.</span>

        <span class="c1"># Exclude non-zero stoichiometric coefficients for S_IC initially since they depend on other stoichiometric coefficients.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rate_reaction_stoichiometry</span> <span class="o">=</span> <span class="p">{</span>
            <span class="c1"># R1: Hydrolysis of carbohydrates</span>
            <span class="p">(</span><span class="s2">&quot;R1&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;H2O&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R1&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_su&quot;</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R1&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_aa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R1&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_fa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R1&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_va&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R1&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_bu&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R1&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_pro&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R1&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_ac&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R1&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_h2&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R1&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_ch4&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R1&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IC&quot;</span><span class="p">):</span> <span class="o">-</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;S_su&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;X_ch&quot;</span><span class="p">])</span> <span class="o">*</span> <span class="n">mw_c</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R1&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IN&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R1&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IP&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R1&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_I&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R1&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_ch&quot;</span><span class="p">):</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R1&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_pr&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R1&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_li&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R1&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_su&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R1&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_aa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R1&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_fa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R1&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_c4&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R1&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_pro&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R1&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_ac&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R1&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_h2&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R1&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_I&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R1&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PHA&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R1&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PP&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R1&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PAO&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R1&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_K&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R1&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_Mg&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="c1"># R2:  Hydrolysis of proteins</span>
            <span class="p">(</span><span class="s2">&quot;R2&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;H2O&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R2&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_su&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R2&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_aa&quot;</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R2&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_fa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R2&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_va&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R2&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_bu&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R2&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_pro&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R2&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_ac&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R2&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_h2&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R2&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_ch4&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R2&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IC&quot;</span><span class="p">):</span> <span class="o">-</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;S_aa&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;X_pr&quot;</span><span class="p">])</span> <span class="o">*</span> <span class="n">mw_c</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R2&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IN&quot;</span><span class="p">):</span> <span class="o">-</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Ni</span><span class="p">[</span><span class="s2">&quot;S_aa&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ni</span><span class="p">[</span><span class="s2">&quot;X_pr&quot;</span><span class="p">])</span> <span class="o">*</span> <span class="n">mw_n</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R2&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IP&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R2&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_I&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R2&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_ch&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R2&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_pr&quot;</span><span class="p">):</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R2&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_li&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R2&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_su&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R2&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_aa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R2&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_fa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R2&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_c4&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R2&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_pro&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R2&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_ac&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R2&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_h2&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R2&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_I&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R2&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PHA&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R2&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PP&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R2&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PAO&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R2&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_K&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R2&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_Mg&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="c1"># R3:  Hydrolysis of lipids</span>
            <span class="p">(</span><span class="s2">&quot;R3&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;H2O&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R3&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_su&quot;</span><span class="p">):</span> <span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_fa_li</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R3&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_aa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R3&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_fa&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_fa_li</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R3&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_va&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R3&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_bu&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R3&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_pro&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R3&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_ac&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R3&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_h2&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R3&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_ch4&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R3&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IC&quot;</span><span class="p">):</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;X_li&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_fa_li</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;S_su&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_fa_li</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;S_fa&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="o">*</span> <span class="n">mw_c</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R3&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IN&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R3&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IP&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">Pi</span><span class="p">[</span><span class="s2">&quot;X_li&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">mw_p</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R3&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_I&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R3&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_ch&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R3&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_pr&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R3&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_li&quot;</span><span class="p">):</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R3&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_su&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R3&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_aa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R3&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_fa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R3&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_c4&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R3&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_pro&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R3&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_ac&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R3&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_h2&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R3&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_I&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R3&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PHA&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R3&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PP&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R3&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PAO&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R3&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_K&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R3&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_Mg&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="c1"># R4:  Uptake of sugars</span>
            <span class="p">(</span><span class="s2">&quot;R4&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;H2O&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R4&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_su&quot;</span><span class="p">):</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R4&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_aa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R4&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_fa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R4&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_va&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R4&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_bu&quot;</span><span class="p">):</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y_su</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_bu_su</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R4&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_pro&quot;</span><span class="p">):</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y_su</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_pro_su</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R4&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_ac&quot;</span><span class="p">):</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y_su</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_ac_su</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R4&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_h2&quot;</span><span class="p">):</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y_su</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_h2_su</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R4&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_ch4&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R4&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IC&quot;</span><span class="p">):</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;S_su&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y_su</span><span class="p">)</span>
                <span class="o">*</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">f_bu_su</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;S_bu&quot;</span><span class="p">]</span>
                    <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_pro_su</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;S_pro&quot;</span><span class="p">]</span>
                    <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_ac_su</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;S_ac&quot;</span><span class="p">]</span>
                <span class="p">)</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y_su</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;X_su&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="o">*</span> <span class="n">mw_c</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R4&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IN&quot;</span><span class="p">):</span> <span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">Y_su</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ni</span><span class="p">[</span><span class="s2">&quot;X_su&quot;</span><span class="p">])</span> <span class="o">*</span> <span class="n">mw_n</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R4&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IP&quot;</span><span class="p">):</span> <span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">Y_su</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Pi</span><span class="p">[</span><span class="s2">&quot;X_su&quot;</span><span class="p">])</span> <span class="o">*</span> <span class="n">mw_p</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R4&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_I&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R4&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_ch&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R4&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_pr&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R4&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_li&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R4&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_su&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y_su</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R4&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_aa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R4&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_fa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R4&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_c4&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R4&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_pro&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R4&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_ac&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R4&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_h2&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R4&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_I&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R4&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PHA&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R4&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PP&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R4&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PAO&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R4&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_K&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R4&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_Mg&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="c1"># R5:  Uptake of amino acids</span>
            <span class="p">(</span><span class="s2">&quot;R5&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;H2O&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R5&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_su&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R5&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_aa&quot;</span><span class="p">):</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R5&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_fa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R5&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_va&quot;</span><span class="p">):</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y_aa</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_va_aa</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R5&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_bu&quot;</span><span class="p">):</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y_aa</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_bu_aa</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R5&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_pro&quot;</span><span class="p">):</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y_aa</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_pro_aa</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R5&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_ac&quot;</span><span class="p">):</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y_aa</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_ac_aa</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R5&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_h2&quot;</span><span class="p">):</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y_aa</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_h2_aa</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R5&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_ch4&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R5&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IC&quot;</span><span class="p">):</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;S_aa&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y_aa</span><span class="p">)</span>
                <span class="o">*</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">f_va_aa</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;S_va&quot;</span><span class="p">]</span>
                    <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_bu_aa</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;S_bu&quot;</span><span class="p">]</span>
                    <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_pro_aa</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;S_pro&quot;</span><span class="p">]</span>
                    <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_ac_aa</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;S_ac&quot;</span><span class="p">]</span>
                <span class="p">)</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y_aa</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;X_aa&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="o">*</span> <span class="n">mw_c</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R5&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IN&quot;</span><span class="p">):</span> <span class="o">-</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">Ni</span><span class="p">[</span><span class="s2">&quot;S_aa&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y_aa</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ni</span><span class="p">[</span><span class="s2">&quot;X_aa&quot;</span><span class="p">])</span>
            <span class="o">*</span> <span class="n">mw_n</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R5&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IP&quot;</span><span class="p">):</span> <span class="o">-</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y_aa</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Pi</span><span class="p">[</span><span class="s2">&quot;X_aa&quot;</span><span class="p">])</span> <span class="o">*</span> <span class="n">mw_p</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R5&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_I&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R5&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_ch&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R5&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_pr&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R5&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_li&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R5&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_su&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R5&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_aa&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y_aa</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R5&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_fa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R5&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_c4&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R5&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_pro&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R5&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_ac&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R5&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_h2&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R5&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_I&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R5&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PHA&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R5&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PP&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R5&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PAO&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R5&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_K&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R5&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_Mg&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="c1"># R6:  Uptake of long chain fatty acids (LCFAs)</span>
            <span class="p">(</span><span class="s2">&quot;R6&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;H2O&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R6&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_su&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R6&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_aa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R6&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_fa&quot;</span><span class="p">):</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R6&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_va&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R6&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_bu&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R6&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_pro&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R6&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_ac&quot;</span><span class="p">):</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y_fa</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.7</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R6&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_h2&quot;</span><span class="p">):</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y_fa</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.3</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R6&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_ch4&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R6&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IC&quot;</span><span class="p">):</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;S_fa&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y_fa</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.7</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;S_ac&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y_fa</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;X_fa&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="o">*</span> <span class="n">mw_c</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R6&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IN&quot;</span><span class="p">):</span> <span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">Y_fa</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ni</span><span class="p">[</span><span class="s2">&quot;X_fa&quot;</span><span class="p">])</span> <span class="o">*</span> <span class="n">mw_n</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R6&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IP&quot;</span><span class="p">):</span> <span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">Y_fa</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Pi</span><span class="p">[</span><span class="s2">&quot;X_fa&quot;</span><span class="p">])</span> <span class="o">*</span> <span class="n">mw_p</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R6&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_I&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R6&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_ch&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R6&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_pr&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R6&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_li&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R6&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_su&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R6&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_aa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R6&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_fa&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y_fa</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R6&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_c4&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R6&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_pro&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R6&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_ac&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R6&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_h2&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R6&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_I&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R6&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PHA&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R6&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PP&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R6&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PAO&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R6&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_K&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R6&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_Mg&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="c1"># R7:  Uptake of valerate</span>
            <span class="p">(</span><span class="s2">&quot;R7&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;H2O&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R7&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_su&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R7&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_aa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R7&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_fa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R7&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_va&quot;</span><span class="p">):</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R7&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_bu&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R7&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_pro&quot;</span><span class="p">):</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y_c4</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.54</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R7&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_ac&quot;</span><span class="p">):</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y_c4</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.31</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R7&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_h2&quot;</span><span class="p">):</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y_c4</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.15</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R7&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_ch4&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R7&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IC&quot;</span><span class="p">):</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;S_va&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y_c4</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.54</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;S_pro&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y_c4</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.31</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;S_ac&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y_c4</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;X_c4&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="o">*</span> <span class="n">mw_c</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R7&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IN&quot;</span><span class="p">):</span> <span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">Y_c4</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ni</span><span class="p">[</span><span class="s2">&quot;X_c4&quot;</span><span class="p">])</span> <span class="o">*</span> <span class="n">mw_n</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R7&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IP&quot;</span><span class="p">):</span> <span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">Y_c4</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Pi</span><span class="p">[</span><span class="s2">&quot;X_c4&quot;</span><span class="p">])</span> <span class="o">*</span> <span class="n">mw_p</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R7&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_I&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R7&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_ch&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R7&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_pr&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R7&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_li&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R7&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_su&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R7&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_aa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R7&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_fa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R7&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_c4&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y_c4</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R7&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_pro&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R7&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_ac&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R7&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_h2&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R7&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_I&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R7&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PHA&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R7&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PP&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R7&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PAO&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R7&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_K&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R7&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_Mg&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="c1"># R8:  Uptake of butyrate</span>
            <span class="p">(</span><span class="s2">&quot;R8&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;H2O&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R8&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_su&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R8&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_aa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R8&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_fa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R8&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_va&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R8&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_bu&quot;</span><span class="p">):</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R8&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_pro&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R8&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_ac&quot;</span><span class="p">):</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y_c4</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R8&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_h2&quot;</span><span class="p">):</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y_c4</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.2</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R8&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_ch4&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R8&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IC&quot;</span><span class="p">):</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;S_bu&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y_c4</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.8</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;S_ac&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y_c4</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;X_c4&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="o">*</span> <span class="n">mw_c</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R8&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IN&quot;</span><span class="p">):</span> <span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">Y_c4</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ni</span><span class="p">[</span><span class="s2">&quot;X_c4&quot;</span><span class="p">])</span> <span class="o">*</span> <span class="n">mw_n</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R8&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IP&quot;</span><span class="p">):</span> <span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">Y_c4</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Pi</span><span class="p">[</span><span class="s2">&quot;X_c4&quot;</span><span class="p">])</span> <span class="o">*</span> <span class="n">mw_p</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R8&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_I&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R8&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_ch&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R8&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_pr&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R8&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_li&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R8&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_su&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R8&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_aa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R8&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_fa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R8&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_c4&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y_c4</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R8&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_pro&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R8&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_ac&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R8&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_h2&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R8&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_I&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R8&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PHA&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R8&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PP&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R8&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PAO&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R8&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_K&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R8&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_Mg&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="c1"># R9: Uptake of propionate</span>
            <span class="p">(</span><span class="s2">&quot;R9&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;H2O&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R9&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_su&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R9&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_aa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R9&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_fa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R9&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_va&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R9&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_bu&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R9&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_pro&quot;</span><span class="p">):</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R9&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_ac&quot;</span><span class="p">):</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y_pro</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.57</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R9&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_h2&quot;</span><span class="p">):</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y_pro</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.43</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R9&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_ch4&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R9&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IC&quot;</span><span class="p">):</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;S_pro&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y_pro</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.57</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;S_ac&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y_pro</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;X_pro&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="o">*</span> <span class="n">mw_c</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R9&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IN&quot;</span><span class="p">):</span> <span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">Y_pro</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ni</span><span class="p">[</span><span class="s2">&quot;X_pro&quot;</span><span class="p">])</span> <span class="o">*</span> <span class="n">mw_n</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R9&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IP&quot;</span><span class="p">):</span> <span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">Y_pro</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Pi</span><span class="p">[</span><span class="s2">&quot;X_pro&quot;</span><span class="p">])</span> <span class="o">*</span> <span class="n">mw_p</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R9&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_I&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R9&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_ch&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R9&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_pr&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R9&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_li&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R9&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_su&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R9&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_aa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R9&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_fa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R9&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_c4&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R9&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_pro&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y_pro</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R9&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_ac&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R9&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_h2&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R9&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_I&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R9&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PHA&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R9&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PP&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R9&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PAO&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R9&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_K&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R9&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_Mg&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="c1"># R10: Uptake of acetate</span>
            <span class="p">(</span><span class="s2">&quot;R10&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;H2O&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R10&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_su&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R10&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_aa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R10&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_fa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R10&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_va&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R10&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_bu&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R10&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_pro&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R10&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_ac&quot;</span><span class="p">):</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R10&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_h2&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R10&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_ch4&quot;</span><span class="p">):</span> <span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y_ac</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R10&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IC&quot;</span><span class="p">):</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;S_ac&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y_ac</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;S_ch4&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y_ac</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;X_ac&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="o">*</span> <span class="n">mw_c</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R10&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IN&quot;</span><span class="p">):</span> <span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">Y_ac</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ni</span><span class="p">[</span><span class="s2">&quot;X_ac&quot;</span><span class="p">])</span> <span class="o">*</span> <span class="n">mw_n</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R10&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IP&quot;</span><span class="p">):</span> <span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">Y_ac</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Pi</span><span class="p">[</span><span class="s2">&quot;X_ac&quot;</span><span class="p">])</span> <span class="o">*</span> <span class="n">mw_p</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R10&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_I&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R10&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_ch&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R10&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_pr&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R10&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_li&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R10&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_su&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R10&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_aa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R10&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_fa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R10&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_c4&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R10&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_pro&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R10&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_ac&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y_ac</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R10&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_h2&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R10&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_I&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R10&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PHA&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R10&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PP&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R10&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PAO&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R10&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_K&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R10&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_Mg&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="c1"># R11: Uptake of hydrogen</span>
            <span class="p">(</span><span class="s2">&quot;R11&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;H2O&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R11&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_su&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R11&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_aa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R11&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_fa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R11&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_va&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R11&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_bu&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R11&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_pro&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R11&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_ac&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R11&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_h2&quot;</span><span class="p">):</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R11&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_ch4&quot;</span><span class="p">):</span> <span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y_h2</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R11&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IC&quot;</span><span class="p">):</span> <span class="p">(</span>
                <span class="o">-</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y_h2</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;S_ch4&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y_h2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;X_h2&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="o">*</span> <span class="n">mw_c</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R11&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IN&quot;</span><span class="p">):</span> <span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">Y_h2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ni</span><span class="p">[</span><span class="s2">&quot;X_h2&quot;</span><span class="p">])</span> <span class="o">*</span> <span class="n">mw_n</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R11&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IP&quot;</span><span class="p">):</span> <span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">Y_h2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Pi</span><span class="p">[</span><span class="s2">&quot;X_h2&quot;</span><span class="p">])</span> <span class="o">*</span> <span class="n">mw_p</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R11&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_I&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R11&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_ch&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R11&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_pr&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R11&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_li&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R11&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_su&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R11&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_aa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R11&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_fa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R11&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_c4&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R11&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_pro&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R11&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_ac&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R11&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_h2&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y_h2</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R11&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_I&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R11&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PHA&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R11&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PP&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R11&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PAO&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R11&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_K&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R11&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_Mg&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="c1"># R12: Decay of X_su</span>
            <span class="p">(</span><span class="s2">&quot;R12&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;H2O&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R12&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_su&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R12&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_aa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R12&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_fa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R12&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_va&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R12&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_bu&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R12&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_pro&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R12&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_ac&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R12&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_h2&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R12&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_ch4&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R12&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IC&quot;</span><span class="p">):</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;X_su&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_ch_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;X_ch&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_pr_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;X_pr&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_li_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;X_li&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_xi_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;X_I&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="o">*</span> <span class="n">mw_c</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R12&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IN&quot;</span><span class="p">):</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Ni</span><span class="p">[</span><span class="s2">&quot;X_su&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_pr_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ni</span><span class="p">[</span><span class="s2">&quot;X_pr&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_xi_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ni</span><span class="p">[</span><span class="s2">&quot;X_I&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="o">*</span> <span class="n">mw_n</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R12&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IP&quot;</span><span class="p">):</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Pi</span><span class="p">[</span><span class="s2">&quot;X_su&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_li_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Pi</span><span class="p">[</span><span class="s2">&quot;X_li&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_xi_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Pi</span><span class="p">[</span><span class="s2">&quot;X_I&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="o">*</span> <span class="n">mw_p</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R12&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_I&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_si_xb</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R12&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_ch&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_ch_xb</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R12&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_pr&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_pr_xb</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R12&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_li&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_li_xb</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R12&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_su&quot;</span><span class="p">):</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R12&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_aa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R12&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_fa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R12&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_c4&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R12&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_pro&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R12&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_ac&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R12&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_h2&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R12&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_I&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_xi_xb</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R12&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PHA&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R12&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PP&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R12&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PAO&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R12&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_K&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R12&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_Mg&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="c1"># R13: Decay of X_aa</span>
            <span class="p">(</span><span class="s2">&quot;R13&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;H2O&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R13&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_su&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R13&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_aa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R13&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_fa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R13&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_va&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R13&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_bu&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R13&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_pro&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R13&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_ac&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R13&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_h2&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R13&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_ch4&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R13&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IC&quot;</span><span class="p">):</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;X_aa&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_ch_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;X_ch&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_pr_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;X_pr&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_li_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;X_li&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_xi_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;X_I&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="o">*</span> <span class="n">mw_c</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R13&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IN&quot;</span><span class="p">):</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Ni</span><span class="p">[</span><span class="s2">&quot;X_aa&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_pr_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ni</span><span class="p">[</span><span class="s2">&quot;X_pr&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_xi_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ni</span><span class="p">[</span><span class="s2">&quot;X_I&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="o">*</span> <span class="n">mw_n</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R13&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IP&quot;</span><span class="p">):</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Pi</span><span class="p">[</span><span class="s2">&quot;X_aa&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_li_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Pi</span><span class="p">[</span><span class="s2">&quot;X_li&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_xi_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Pi</span><span class="p">[</span><span class="s2">&quot;X_I&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="o">*</span> <span class="n">mw_p</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R13&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_I&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_si_xb</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R13&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_ch&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_ch_xb</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R13&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_pr&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_pr_xb</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R13&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_li&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_li_xb</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R13&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_su&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R13&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_aa&quot;</span><span class="p">):</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R13&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_fa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R13&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_c4&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R13&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_pro&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R13&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_ac&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R13&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_h2&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R13&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_I&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_xi_xb</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R13&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PHA&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R13&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PP&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R13&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PAO&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R13&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_K&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R13&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_Mg&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="c1"># R14: Decay of X_fa</span>
            <span class="p">(</span><span class="s2">&quot;R14&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;H2O&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R14&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_su&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R14&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_aa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R14&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_fa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R14&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_va&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R14&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_bu&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R14&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_pro&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R14&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_ac&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R14&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_h2&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R14&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_ch4&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R14&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IC&quot;</span><span class="p">):</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;X_fa&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_ch_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;X_ch&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_pr_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;X_pr&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_li_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;X_li&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_xi_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;X_I&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="o">*</span> <span class="n">mw_c</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R14&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IN&quot;</span><span class="p">):</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Ni</span><span class="p">[</span><span class="s2">&quot;X_fa&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_pr_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ni</span><span class="p">[</span><span class="s2">&quot;X_pr&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_xi_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ni</span><span class="p">[</span><span class="s2">&quot;X_I&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="o">*</span> <span class="n">mw_n</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R14&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IP&quot;</span><span class="p">):</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Pi</span><span class="p">[</span><span class="s2">&quot;X_fa&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_li_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Pi</span><span class="p">[</span><span class="s2">&quot;X_li&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_xi_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Pi</span><span class="p">[</span><span class="s2">&quot;X_I&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="o">*</span> <span class="n">mw_p</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R14&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_I&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_si_xb</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R14&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_ch&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_ch_xb</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R14&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_pr&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_pr_xb</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R14&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_li&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_li_xb</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R14&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_su&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R14&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_aa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R14&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_fa&quot;</span><span class="p">):</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R14&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_c4&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R14&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_pro&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R14&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_ac&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R14&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_h2&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R14&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_I&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_xi_xb</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R14&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PHA&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R14&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PP&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R14&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PAO&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R14&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_K&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R14&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_Mg&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="c1"># R15: Decay of X_c4</span>
            <span class="p">(</span><span class="s2">&quot;R15&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;H2O&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R15&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_su&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R15&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_aa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R15&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_fa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R15&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_va&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R15&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_bu&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R15&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_pro&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R15&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_ac&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R15&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_h2&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R15&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_ch4&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R15&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IC&quot;</span><span class="p">):</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;X_c4&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_ch_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;X_ch&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_pr_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;X_pr&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_li_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;X_li&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_xi_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;X_I&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="o">*</span> <span class="n">mw_c</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R15&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IN&quot;</span><span class="p">):</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Ni</span><span class="p">[</span><span class="s2">&quot;X_c4&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_pr_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ni</span><span class="p">[</span><span class="s2">&quot;X_pr&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_xi_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ni</span><span class="p">[</span><span class="s2">&quot;X_I&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="o">*</span> <span class="n">mw_n</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R15&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IP&quot;</span><span class="p">):</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Pi</span><span class="p">[</span><span class="s2">&quot;X_c4&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_li_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Pi</span><span class="p">[</span><span class="s2">&quot;X_li&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_xi_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Pi</span><span class="p">[</span><span class="s2">&quot;X_I&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="o">*</span> <span class="n">mw_p</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R15&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_I&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_si_xb</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R15&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_ch&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_ch_xb</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R15&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_pr&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_pr_xb</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R15&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_li&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_li_xb</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R15&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_su&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R15&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_aa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R15&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_fa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R15&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_c4&quot;</span><span class="p">):</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R15&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_pro&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R15&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_ac&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R15&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_h2&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R15&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_I&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_xi_xb</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R15&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PHA&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R15&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PP&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R15&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PAO&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R15&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_K&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R15&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_Mg&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="c1"># R16: Decay of X_pro</span>
            <span class="p">(</span><span class="s2">&quot;R16&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;H2O&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R16&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_su&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R16&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_aa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R16&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_fa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R16&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_va&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R16&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_bu&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R16&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_pro&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R16&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_ac&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R16&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_h2&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R16&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_ch4&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R16&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IC&quot;</span><span class="p">):</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;X_pro&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_ch_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;X_ch&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_pr_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;X_pr&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_li_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;X_li&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_xi_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;X_I&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="o">*</span> <span class="n">mw_c</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R16&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IN&quot;</span><span class="p">):</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Ni</span><span class="p">[</span><span class="s2">&quot;X_pro&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_pr_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ni</span><span class="p">[</span><span class="s2">&quot;X_pr&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_xi_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ni</span><span class="p">[</span><span class="s2">&quot;X_I&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="o">*</span> <span class="n">mw_n</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R16&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IP&quot;</span><span class="p">):</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Pi</span><span class="p">[</span><span class="s2">&quot;X_pro&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_li_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Pi</span><span class="p">[</span><span class="s2">&quot;X_li&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_xi_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Pi</span><span class="p">[</span><span class="s2">&quot;X_I&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="o">*</span> <span class="n">mw_p</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R16&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_I&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_si_xb</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R16&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_ch&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_ch_xb</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R16&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_pr&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_pr_xb</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R16&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_li&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_li_xb</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R16&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_su&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R16&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_aa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R16&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_fa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R16&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_c4&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R16&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_pro&quot;</span><span class="p">):</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R16&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_ac&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R16&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_h2&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R16&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_I&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_xi_xb</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R16&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PHA&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R16&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PP&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R16&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PAO&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R16&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_K&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R16&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_Mg&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="c1"># R17: Decay of X_ac</span>
            <span class="p">(</span><span class="s2">&quot;R17&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;H2O&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R17&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_su&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R17&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_aa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R17&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_fa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R17&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_va&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R17&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_bu&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R17&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_pro&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R17&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_ac&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R17&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_h2&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R17&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_ch4&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R17&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IC&quot;</span><span class="p">):</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;X_ac&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_ch_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;X_ch&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_pr_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;X_pr&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_li_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;X_li&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_xi_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;X_I&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="o">*</span> <span class="n">mw_c</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R17&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IN&quot;</span><span class="p">):</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Ni</span><span class="p">[</span><span class="s2">&quot;X_ac&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_pr_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ni</span><span class="p">[</span><span class="s2">&quot;X_pr&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_xi_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ni</span><span class="p">[</span><span class="s2">&quot;X_I&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="o">*</span> <span class="n">mw_n</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R17&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IP&quot;</span><span class="p">):</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Pi</span><span class="p">[</span><span class="s2">&quot;X_ac&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_li_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Pi</span><span class="p">[</span><span class="s2">&quot;X_li&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_xi_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Pi</span><span class="p">[</span><span class="s2">&quot;X_I&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="o">*</span> <span class="n">mw_p</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R17&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_I&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_si_xb</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R17&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_ch&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_ch_xb</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R17&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_pr&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_pr_xb</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R17&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_li&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_li_xb</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R17&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_su&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R17&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_aa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R17&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_fa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R17&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_c4&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R17&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_pro&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R17&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_ac&quot;</span><span class="p">):</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R17&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_h2&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R17&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_I&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_xi_xb</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R17&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PHA&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R17&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PP&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R17&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PAO&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R17&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_K&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R17&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_Mg&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="c1"># R18: Decay of X_h2</span>
            <span class="p">(</span><span class="s2">&quot;R18&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;H2O&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R18&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_su&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R18&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_aa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R18&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_fa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R18&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_va&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R18&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_bu&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R18&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_pro&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R18&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_ac&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R18&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_h2&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R18&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_ch4&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R18&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IC&quot;</span><span class="p">):</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;X_h2&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_ch_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;X_ch&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_pr_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;X_pr&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_li_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;X_li&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_xi_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;X_I&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="o">*</span> <span class="n">mw_c</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R18&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IN&quot;</span><span class="p">):</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Ni</span><span class="p">[</span><span class="s2">&quot;X_h2&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_pr_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ni</span><span class="p">[</span><span class="s2">&quot;X_pr&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_xi_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ni</span><span class="p">[</span><span class="s2">&quot;X_I&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="o">*</span> <span class="n">mw_n</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R18&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IP&quot;</span><span class="p">):</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Pi</span><span class="p">[</span><span class="s2">&quot;X_h2&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_li_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Pi</span><span class="p">[</span><span class="s2">&quot;X_li&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_xi_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Pi</span><span class="p">[</span><span class="s2">&quot;X_I&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="o">*</span> <span class="n">mw_p</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R18&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_I&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_si_xb</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R18&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_ch&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_ch_xb</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R18&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_pr&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_pr_xb</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R18&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_li&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_li_xb</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R18&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_su&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R18&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_aa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R18&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_fa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R18&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_c4&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R18&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_pro&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R18&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_ac&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R18&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_h2&quot;</span><span class="p">):</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R18&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_I&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_xi_xb</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R18&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PHA&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R18&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PP&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R18&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PAO&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R18&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_K&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R18&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_Mg&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="c1"># R19: Storage of S_va in X_PHA</span>
            <span class="p">(</span><span class="s2">&quot;R19&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;H2O&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R19&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_su&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R19&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_aa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R19&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_fa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R19&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_va&quot;</span><span class="p">):</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R19&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_bu&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R19&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_pro&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R19&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_ac&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R19&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_h2&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R19&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_ch4&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R19&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IC&quot;</span><span class="p">):</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;S_va&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;X_PHA&quot;</span><span class="p">])</span> <span class="o">*</span> <span class="n">mw_c</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R19&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IN&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R19&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IP&quot;</span><span class="p">):</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y_PO4</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Pi</span><span class="p">[</span><span class="s2">&quot;X_PP&quot;</span><span class="p">])</span> <span class="o">*</span> <span class="n">mw_p</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R19&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_I&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R19&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_ch&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R19&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_pr&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R19&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_li&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R19&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_su&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R19&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_aa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R19&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_fa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R19&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_c4&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R19&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_pro&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R19&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_ac&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R19&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_h2&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R19&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_I&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R19&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PHA&quot;</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R19&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PP&quot;</span><span class="p">):</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">Y_PO4</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R19&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PAO&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R19&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_K&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y_PO4</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">K_XPP</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R19&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_Mg&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y_PO4</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Mg_XPP</span><span class="p">,</span>
            <span class="c1"># R20: Storage of S_bu in X_PHA</span>
            <span class="p">(</span><span class="s2">&quot;R20&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;H2O&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R20&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_su&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R20&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_aa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R20&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_fa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R20&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_va&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R20&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_bu&quot;</span><span class="p">):</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R20&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_pro&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R20&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_ac&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R20&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_h2&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R20&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_ch4&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R20&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IC&quot;</span><span class="p">):</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;S_bu&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;X_PHA&quot;</span><span class="p">])</span> <span class="o">*</span> <span class="n">mw_c</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R20&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IN&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R20&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IP&quot;</span><span class="p">):</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y_PO4</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Pi</span><span class="p">[</span><span class="s2">&quot;X_PP&quot;</span><span class="p">])</span> <span class="o">*</span> <span class="n">mw_p</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R20&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_I&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R20&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_ch&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R20&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_pr&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R20&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_li&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R20&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_su&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R20&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_aa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R20&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_fa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R20&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_c4&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R20&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_pro&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R20&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_ac&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R20&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_h2&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R20&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_I&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R20&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PHA&quot;</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R20&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PP&quot;</span><span class="p">):</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">Y_PO4</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R20&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PAO&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R20&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_K&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y_PO4</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">K_XPP</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R20&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_Mg&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y_PO4</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Mg_XPP</span><span class="p">,</span>
            <span class="c1"># R21: Storage of S_pro in X_PHA</span>
            <span class="p">(</span><span class="s2">&quot;R21&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;H2O&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R21&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_su&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R21&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_aa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R21&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_fa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R21&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_va&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R21&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_bu&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R21&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_pro&quot;</span><span class="p">):</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R21&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_ac&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R21&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_h2&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R21&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_ch4&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R21&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IC&quot;</span><span class="p">):</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;S_pro&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;X_PHA&quot;</span><span class="p">])</span> <span class="o">*</span> <span class="n">mw_c</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R21&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IN&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R21&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IP&quot;</span><span class="p">):</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y_PO4</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Pi</span><span class="p">[</span><span class="s2">&quot;X_PP&quot;</span><span class="p">])</span> <span class="o">*</span> <span class="n">mw_p</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R21&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_I&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R21&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_ch&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R21&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_pr&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R21&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_li&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R21&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_su&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R21&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_aa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R21&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_fa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R21&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_c4&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R21&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_pro&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R21&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_ac&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R21&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_h2&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R21&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_I&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R21&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PHA&quot;</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R21&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PP&quot;</span><span class="p">):</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">Y_PO4</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R21&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PAO&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R21&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_K&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y_PO4</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">K_XPP</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R21&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_Mg&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y_PO4</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Mg_XPP</span><span class="p">,</span>
            <span class="c1"># R22: Storage of S_ac in X_PHA</span>
            <span class="p">(</span><span class="s2">&quot;R22&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;H2O&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R22&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_su&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R22&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_aa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R22&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_fa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R22&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_va&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R22&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_bu&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R22&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_pro&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R22&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_ac&quot;</span><span class="p">):</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R22&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_h2&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R22&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_ch4&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R22&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IC&quot;</span><span class="p">):</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;S_ac&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;X_PHA&quot;</span><span class="p">])</span> <span class="o">*</span> <span class="n">mw_c</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R22&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IN&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R22&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IP&quot;</span><span class="p">):</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y_PO4</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Pi</span><span class="p">[</span><span class="s2">&quot;X_PP&quot;</span><span class="p">])</span> <span class="o">*</span> <span class="n">mw_p</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R22&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_I&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R22&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_ch&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R22&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_pr&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R22&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_li&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R22&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_su&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R22&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_aa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R22&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_fa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R22&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_c4&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R22&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_pro&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R22&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_ac&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R22&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_h2&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R22&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_I&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R22&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PHA&quot;</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R22&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PP&quot;</span><span class="p">):</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">Y_PO4</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R22&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PAO&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R22&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_K&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y_PO4</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">K_XPP</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R22&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_Mg&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y_PO4</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Mg_XPP</span><span class="p">,</span>
            <span class="c1"># R23: Lysis of X_PAO</span>
            <span class="p">(</span><span class="s2">&quot;R23&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;H2O&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R23&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_su&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R23&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_aa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R23&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_fa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R23&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_va&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R23&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_bu&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R23&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_pro&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R23&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_ac&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R23&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_h2&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R23&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_ch4&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R23&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IC&quot;</span><span class="p">):</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;X_PAO&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_ch_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;X_ch&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_pr_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;X_pr&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_li_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;X_li&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_xi_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;X_I&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="o">*</span> <span class="n">mw_c</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R23&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IN&quot;</span><span class="p">):</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Ni</span><span class="p">[</span><span class="s2">&quot;X_PAO&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_pr_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ni</span><span class="p">[</span><span class="s2">&quot;X_pr&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_xi_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ni</span><span class="p">[</span><span class="s2">&quot;X_I&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="o">*</span> <span class="n">mw_n</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R23&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IP&quot;</span><span class="p">):</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Pi</span><span class="p">[</span><span class="s2">&quot;X_PAO&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_li_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Pi</span><span class="p">[</span><span class="s2">&quot;X_li&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_xi_xb</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Pi</span><span class="p">[</span><span class="s2">&quot;X_I&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="o">*</span> <span class="n">mw_p</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R23&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_I&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_si_xb</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R23&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_ch&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_ch_xb</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R23&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_pr&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_pr_xb</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R23&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_li&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_li_xb</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R23&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_su&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R23&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_aa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R23&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_fa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R23&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_c4&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R23&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_pro&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R23&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_ac&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R23&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_h2&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R23&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_I&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_xi_xb</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R23&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PHA&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R23&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PP&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R23&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PAO&quot;</span><span class="p">):</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R23&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_K&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R23&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_Mg&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="c1"># R24: Lysis of X_PP</span>
            <span class="p">(</span><span class="s2">&quot;R24&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;H2O&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R24&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_su&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R24&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_aa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R24&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_fa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R24&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_va&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R24&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_bu&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R24&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_pro&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R24&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_ac&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R24&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_h2&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R24&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_ch4&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R24&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IC&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R24&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IN&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R24&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IP&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">Pi</span><span class="p">[</span><span class="s2">&quot;X_PP&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">mw_p</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R24&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_I&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R24&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_ch&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R24&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_pr&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R24&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_li&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R24&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_su&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R24&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_aa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R24&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_fa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R24&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_c4&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R24&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_pro&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R24&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_ac&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R24&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_h2&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R24&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_I&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R24&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PHA&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R24&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PP&quot;</span><span class="p">):</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R24&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PAO&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R24&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_K&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">K_XPP</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R24&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_Mg&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">Mg_XPP</span><span class="p">,</span>
            <span class="c1"># R25: Lysis of X_PHA</span>
            <span class="p">(</span><span class="s2">&quot;R25&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;H2O&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R25&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_su&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R25&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_aa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R25&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_fa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R25&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_va&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_va_PHA</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R25&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_bu&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_bu_PHA</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R25&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_pro&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_pro_PHA</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R25&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_ac&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_ac_PHA</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R25&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_h2&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R25&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_ch4&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R25&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IC&quot;</span><span class="p">):</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;X_PHA&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_va_PHA</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;S_va&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_bu_PHA</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;S_bu&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_pro_PHA</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;S_pro&quot;</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_ac_PHA</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">[</span><span class="s2">&quot;S_ac&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="o">*</span> <span class="n">mw_c</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R25&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IN&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R25&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_IP&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R25&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_I&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R25&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_ch&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R25&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_pr&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R25&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_li&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R25&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_su&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R25&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_aa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R25&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_fa&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R25&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_c4&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R25&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_pro&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R25&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_ac&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R25&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_h2&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R25&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_I&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R25&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PHA&quot;</span><span class="p">):</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R25&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PP&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R25&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;X_PAO&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R25&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_K&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;R25&quot;</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_Mg&quot;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="k">for</span> <span class="n">R</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rate_reaction_idx</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rate_reaction_stoichiometry</span><span class="p">[</span><span class="n">R</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_cat&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rate_reaction_stoichiometry</span><span class="p">[</span><span class="n">R</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;S_an&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># Fix all the variables we just created</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">component_objects</span><span class="p">(</span><span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">,</span> <span class="n">descend_into</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
            <span class="n">v</span><span class="o">.</span><span class="n">fix</span><span class="p">()</span></div>

<div class="viewcode-block" id="ModifiedADM1ReactionParameterData.define_metadata"><a class="viewcode-back" href="../../../../../technical_reference/property_models/modified_ADM1.html#watertap.property_models.unit_specific.anaerobic_digestion.modified_adm1_reactions.ModifiedADM1ReactionParameterData.define_metadata">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">define_metadata</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">add_properties</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;reaction_rate&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="s2">&quot;_rxn_rate&quot;</span><span class="p">},</span>
            <span class="p">}</span>
        <span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">define_custom_properties</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;conc_mol_co2&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="s2">&quot;_rxn_rate&quot;</span><span class="p">},</span>
                <span class="s2">&quot;I&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="s2">&quot;_I&quot;</span><span class="p">},</span>
            <span class="p">}</span>
        <span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">add_default_units</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">s</span><span class="p">,</span>
                <span class="s2">&quot;length&quot;</span><span class="p">:</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="p">,</span>
                <span class="s2">&quot;mass&quot;</span><span class="p">:</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span><span class="p">,</span>
                <span class="s2">&quot;amount&quot;</span><span class="p">:</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kmol</span><span class="p">,</span>
                <span class="s2">&quot;temperature&quot;</span><span class="p">:</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">K</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">)</span></div></div>


<div class="viewcode-block" id="_ModifiedADM1ReactionBlock"><a class="viewcode-back" href="../../../../../technical_reference/property_models/modified_ADM1.html#watertap.property_models.unit_specific.anaerobic_digestion.modified_adm1_reactions._ModifiedADM1ReactionBlock">[docs]</a><span class="k">class</span> <span class="nc">_ModifiedADM1ReactionBlock</span><span class="p">(</span><span class="n">ReactionBlockBase</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This Class contains methods which should be applied to Reaction Blocks as a</span>
<span class="sd">    whole, rather than individual elements of indexed Reaction Blocks.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="_ModifiedADM1ReactionBlock.initialize"><a class="viewcode-back" href="../../../../../technical_reference/property_models/modified_ADM1.html#watertap.property_models.unit_specific.anaerobic_digestion.modified_adm1_reactions._ModifiedADM1ReactionBlock.initialize">[docs]</a>    <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outlvl</span><span class="o">=</span><span class="n">idaeslog</span><span class="o">.</span><span class="n">NOTSET</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialization routine for reaction package.</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            outlvl : sets output level of initialization routine</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">init_log</span> <span class="o">=</span> <span class="n">idaeslog</span><span class="o">.</span><span class="n">getInitLogger</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">outlvl</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s2">&quot;properties&quot;</span><span class="p">)</span>
        <span class="n">init_log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Initialization Complete.&quot;</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="ModifiedADM1ReactionBlockData"><a class="viewcode-back" href="../../../../../technical_reference/property_models/modified_ADM1.html#watertap.property_models.unit_specific.anaerobic_digestion.modified_adm1_reactions.ModifiedADM1ReactionBlockData">[docs]</a><span class="nd">@declare_process_block_class</span><span class="p">(</span>
    <span class="s2">&quot;ModifiedADM1ReactionBlock&quot;</span><span class="p">,</span> <span class="n">block_class</span><span class="o">=</span><span class="n">_ModifiedADM1ReactionBlock</span>
<span class="p">)</span>
<span class="k">class</span> <span class="nc">ModifiedADM1ReactionBlockData</span><span class="p">(</span><span class="n">ReactionBlockDataBase</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ReactionBlock for ADM1.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="ModifiedADM1ReactionBlockData.build"><a class="viewcode-back" href="../../../../../technical_reference/property_models/modified_ADM1.html#watertap.property_models.unit_specific.anaerobic_digestion.modified_adm1_reactions.ModifiedADM1ReactionBlockData.build">[docs]</a>    <span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Callable method for Block construction</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>

        <span class="c1"># Create references to state vars</span>
        <span class="c1"># Concentration</span>
        <span class="n">add_object_reference</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;conc_mass_comp_ref&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">state_ref</span><span class="o">.</span><span class="n">conc_mass_comp</span><span class="p">)</span>
        <span class="n">add_object_reference</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;temperature&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">state_ref</span><span class="o">.</span><span class="n">temperature</span><span class="p">)</span>

        <span class="c1"># Initial values of rates of reaction derived from Flores-Alsina 2016 GitHub</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rates</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;R1&quot;</span><span class="p">:</span> <span class="mf">1.651e-04</span><span class="p">,</span>
            <span class="s2">&quot;R2&quot;</span><span class="p">:</span> <span class="mf">1.723e-04</span><span class="p">,</span>
            <span class="s2">&quot;R3&quot;</span><span class="p">:</span> <span class="mf">2.290e-04</span><span class="p">,</span>
            <span class="s2">&quot;R4&quot;</span><span class="p">:</span> <span class="mf">5.312e-06</span><span class="p">,</span>
            <span class="s2">&quot;R5&quot;</span><span class="p">:</span> <span class="mf">5.176e-06</span><span class="p">,</span>
            <span class="s2">&quot;R6&quot;</span><span class="p">:</span> <span class="mf">6.436e-06</span><span class="p">,</span>
            <span class="s2">&quot;R7&quot;</span><span class="p">:</span> <span class="mf">1.074e-06</span><span class="p">,</span>
            <span class="s2">&quot;R8&quot;</span><span class="p">:</span> <span class="mf">1.790e-06</span><span class="p">,</span>
            <span class="s2">&quot;R9&quot;</span><span class="p">:</span> <span class="mf">2.355e-06</span><span class="p">,</span>
            <span class="s2">&quot;R10&quot;</span><span class="p">:</span> <span class="mf">5.531e-06</span><span class="p">,</span>
            <span class="s2">&quot;R11&quot;</span><span class="p">:</span> <span class="mf">4.472e-06</span><span class="p">,</span>
            <span class="s2">&quot;R12&quot;</span><span class="p">:</span> <span class="mf">1.294e-07</span><span class="p">,</span>
            <span class="s2">&quot;R13&quot;</span><span class="p">:</span> <span class="mf">1.009e-07</span><span class="p">,</span>
            <span class="s2">&quot;R14&quot;</span><span class="p">:</span> <span class="mf">9.406e-08</span><span class="p">,</span>
            <span class="s2">&quot;R15&quot;</span><span class="p">:</span> <span class="mf">4.185e-08</span><span class="p">,</span>
            <span class="s2">&quot;R16&quot;</span><span class="p">:</span> <span class="mf">2.294e-08</span><span class="p">,</span>
            <span class="s2">&quot;R17&quot;</span><span class="p">:</span> <span class="mf">1.259e-07</span><span class="p">,</span>
            <span class="s2">&quot;R18&quot;</span><span class="p">:</span> <span class="mf">6.535e-08</span><span class="p">,</span>
            <span class="s2">&quot;R19&quot;</span><span class="p">:</span> <span class="mf">1.507e-06</span><span class="p">,</span>
            <span class="s2">&quot;R20&quot;</span><span class="p">:</span> <span class="mf">2.078e-06</span><span class="p">,</span>
            <span class="s2">&quot;R21&quot;</span><span class="p">:</span> <span class="mf">2.630e-06</span><span class="p">,</span>
            <span class="s2">&quot;R22&quot;</span><span class="p">:</span> <span class="mf">1.195e-05</span><span class="p">,</span>
            <span class="s2">&quot;R23&quot;</span><span class="p">:</span> <span class="mf">1.901e-06</span><span class="p">,</span>
            <span class="s2">&quot;R24&quot;</span><span class="p">:</span> <span class="mf">1.481e-09</span><span class="p">,</span>
            <span class="s2">&quot;R25&quot;</span><span class="p">:</span> <span class="mf">1.425e-06</span><span class="p">,</span>
        <span class="p">}</span></div>

    <span class="c1"># Rate of reaction method</span>
    <span class="k">def</span> <span class="nf">_rxn_rate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reaction_rate</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">rate_reaction_idx</span><span class="p">,</span>
            <span class="n">initialize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rates</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">NonNegativeReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Rate of reaction&quot;</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">s</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">I</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">rate_reaction_idx</span><span class="p">,</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mf">1e-8</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Process inhibition term&quot;</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">dimensionless</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pKW</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">dimensionless</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Water dissociation constant&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pK_a_co2</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">6.35</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">dimensionless</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Carbon dioxide acid-base equilibrium constant&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pK_a_IN</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">9.25</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">dimensionless</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Inorganic nitrogen acid-base equilibrium constant&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conc_mass_va</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">0.01159624</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">NonNegativeReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;mass concentration of va-&quot;</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conc_mass_bu</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">0.0132208</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">NonNegativeReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;mass concentration of bu-&quot;</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conc_mass_pro</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">0.015742</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">NonNegativeReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;mass concentration of pro-&quot;</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conc_mass_ac</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">0.1972</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">NonNegativeReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;mass concentration of ac-&quot;</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conc_mol_hco3</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">0.142777</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">NonNegativeReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;molar concentration of hco3&quot;</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kmol</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conc_mol_nh3</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">0.004</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">NonNegativeReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;molar concentration of nh3&quot;</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kmol</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conc_mol_co2</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">0.0099</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">NonNegativeReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;molar concentration of co2&quot;</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kmol</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conc_mol_nh4</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">0.1261</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">NonNegativeReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;molar concentration of nh4&quot;</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kmol</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conc_mol_Mg</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">4.5822e-05</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">NonNegativeReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;molar concentration of Mg+2&quot;</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kmol</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conc_mol_K</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">0.010934</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">NonNegativeReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;molar concentration of K+&quot;</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kmol</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">S_H</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mf">3.4e-8</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">NonNegativeReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;molar concentration of H&quot;</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kmol</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pH</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Var</span><span class="p">(</span>
            <span class="n">initialize</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
            <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">14</span><span class="p">),</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">PositiveReals</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;pH of solution&quot;</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">dimensionless</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">def</span> <span class="nf">Dissociation_rule</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">pyo</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">10</span><span class="o">**-</span><span class="bp">self</span><span class="o">.</span><span class="n">pKW</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span>
                <span class="n">pyo</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">1e-14</span><span class="p">)</span>
                <span class="o">+</span> <span class="mi">55900</span>
                <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">mole</span>
                <span class="o">*</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">joule</span>
                <span class="o">/</span> <span class="p">(</span><span class="n">Constants</span><span class="o">.</span><span class="n">gas_constant</span><span class="p">)</span>
                <span class="o">*</span> <span class="p">((</span><span class="mi">1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">temperature_ref</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature</span><span class="p">))</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Dissociation</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span>
            <span class="n">rule</span><span class="o">=</span><span class="n">Dissociation_rule</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Water dissociation constant constraint&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">def</span> <span class="nf">CO2_acid_base_equilibrium_rule</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">pyo</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">10</span><span class="o">**-</span><span class="bp">self</span><span class="o">.</span><span class="n">pK_a_co2</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span>
                <span class="n">pyo</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">10</span><span class="o">**-</span><span class="mf">6.35</span><span class="p">)</span>
                <span class="o">+</span> <span class="mi">7646</span>
                <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">mole</span>
                <span class="o">*</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">joule</span>
                <span class="o">/</span> <span class="p">(</span><span class="n">Constants</span><span class="o">.</span><span class="n">gas_constant</span><span class="p">)</span>
                <span class="o">*</span> <span class="p">((</span><span class="mi">1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">temperature_ref</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature</span><span class="p">))</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">CO2_acid_base_equilibrium</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span>
            <span class="n">rule</span><span class="o">=</span><span class="n">CO2_acid_base_equilibrium_rule</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Carbon dioxide acid-base equilibrium constraint&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">def</span> <span class="nf">IN_acid_base_equilibrium_rule</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">pyo</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">10</span><span class="o">**-</span><span class="bp">self</span><span class="o">.</span><span class="n">pK_a_IN</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span>
                <span class="n">pyo</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">10</span><span class="o">**-</span><span class="mf">9.25</span><span class="p">)</span>
                <span class="o">+</span> <span class="mi">51965</span>
                <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">mole</span>
                <span class="o">*</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">joule</span>
                <span class="o">/</span> <span class="p">(</span><span class="n">Constants</span><span class="o">.</span><span class="n">gas_constant</span><span class="p">)</span>
                <span class="o">*</span> <span class="p">((</span><span class="mi">1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">temperature_ref</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature</span><span class="p">))</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">IN_acid_base_equilibrium</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span>
            <span class="n">rule</span><span class="o">=</span><span class="n">IN_acid_base_equilibrium_rule</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Nitrogen acid-base equilibrium constraint&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">def</span> <span class="nf">rule_pH</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pH</span> <span class="o">==</span> <span class="o">-</span><span class="n">pyo</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">S_H</span> <span class="o">/</span> <span class="p">(</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kmole</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">pH_calc</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span><span class="n">rule</span><span class="o">=</span><span class="n">rule_pH</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;pH of solution&quot;</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">concentration_of_va_rule</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">conc_mass_va</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">S_H</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">K_a_va</span><span class="p">)</span>
                <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;S_va&quot;</span><span class="p">]</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">concentration_of_va</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span>
            <span class="n">rule</span><span class="o">=</span><span class="n">concentration_of_va_rule</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;constraint concentration of va-&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">def</span> <span class="nf">concentration_of_bu_rule</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">conc_mass_bu</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">S_H</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">K_a_bu</span><span class="p">)</span>
                <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;S_bu&quot;</span><span class="p">]</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">concentration_of_bu</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span>
            <span class="n">rule</span><span class="o">=</span><span class="n">concentration_of_bu_rule</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;constraint concentration of bu-&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">def</span> <span class="nf">concentration_of_pro_rule</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">conc_mass_pro</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">S_H</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">K_a_pro</span><span class="p">)</span>
                <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;S_pro&quot;</span><span class="p">]</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">concentration_of_pro</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span>
            <span class="n">rule</span><span class="o">=</span><span class="n">concentration_of_pro_rule</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;constraint concentration of pro-&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">def</span> <span class="nf">concentration_of_ac_rule</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">conc_mass_ac</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">S_H</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">K_a_ac</span><span class="p">)</span>
                <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;S_ac&quot;</span><span class="p">]</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">concentration_of_ac</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span>
            <span class="n">rule</span><span class="o">=</span><span class="n">concentration_of_ac_rule</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;constraint concentration of ac-&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">def</span> <span class="nf">concentration_of_hco3_rule</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pK_a_co2</span>
                <span class="o">==</span> <span class="n">pyo</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conc_mol_co2</span> <span class="o">/</span> <span class="p">(</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kmole</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span>
                <span class="o">-</span> <span class="n">pyo</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conc_mol_hco3</span> <span class="o">/</span> <span class="p">(</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kmole</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span>
                <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">pH</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">concentration_of_hco3</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span>
            <span class="n">rule</span><span class="o">=</span><span class="n">concentration_of_hco3_rule</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;constraint concentration of hco3&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">def</span> <span class="nf">concentration_of_nh3_rule</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pK_a_IN</span>
                <span class="o">==</span> <span class="n">pyo</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conc_mol_nh4</span> <span class="o">/</span> <span class="p">(</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kmole</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span>
                <span class="o">-</span> <span class="n">pyo</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conc_mol_nh3</span> <span class="o">/</span> <span class="p">(</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kmole</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span>
                <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">pH</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">concentration_of_nh3</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span>
            <span class="n">rule</span><span class="o">=</span><span class="n">concentration_of_nh3_rule</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;constraint concentration of nh3&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># TO DO: use correct conversion number</span>
        <span class="k">def</span> <span class="nf">concentration_of_co2_rule</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">conc_mol_co2</span>
                <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;S_IC&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">mw_c</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">conc_mol_hco3</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">concentration_of_co2</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span>
            <span class="n">rule</span><span class="o">=</span><span class="n">concentration_of_co2_rule</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;constraint concentration of co2&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">def</span> <span class="nf">concentration_of_nh4_rule</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">conc_mol_nh4</span>
                <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;S_IN&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">mw_n</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">conc_mol_nh3</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">concentration_of_nh4</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span>
            <span class="n">rule</span><span class="o">=</span><span class="n">concentration_of_nh4_rule</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;constraint concentration of nh4&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">def</span> <span class="nf">concentration_of_Mg_rule</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">conc_mol_Mg</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;X_PP&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span>
                <span class="mf">300.41</span> <span class="o">*</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kmol</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">concentration_of_Mg</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span>
            <span class="n">rule</span><span class="o">=</span><span class="n">concentration_of_Mg_rule</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;constraint concentration of Mg&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">def</span> <span class="nf">concentration_of_K_rule</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">conc_mol_K</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;X_PP&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span>
                <span class="mf">300.41</span> <span class="o">*</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kmol</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">concentration_of_K</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span>
            <span class="n">rule</span><span class="o">=</span><span class="n">concentration_of_K_rule</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;constraint concentration of K&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">def</span> <span class="nf">S_H_rule</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">state_ref</span><span class="o">.</span><span class="n">cations</span>
                <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">conc_mol_nh4</span>
                <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">conc_mol_Mg</span>
                <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">conc_mol_K</span>
                <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">S_H</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">conc_mol_hco3</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">conc_mass_ac</span> <span class="o">/</span> <span class="p">(</span><span class="mi">64</span> <span class="o">*</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kmol</span><span class="p">)</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">conc_mass_pro</span> <span class="o">/</span> <span class="p">(</span><span class="mi">112</span> <span class="o">*</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kmol</span><span class="p">)</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">conc_mass_bu</span> <span class="o">/</span> <span class="p">(</span><span class="mi">160</span> <span class="o">*</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kmol</span><span class="p">)</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">conc_mass_va</span> <span class="o">/</span> <span class="p">(</span><span class="mi">208</span> <span class="o">*</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kmol</span><span class="p">)</span>
                <span class="o">-</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pH</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">pKW</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kmole</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">state_ref</span><span class="o">.</span><span class="n">anions</span>
                <span class="o">==</span> <span class="mi">0</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">S_H_cons</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span>
            <span class="n">rule</span><span class="o">=</span><span class="n">S_H_rule</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;constraint concentration of H&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">def</span> <span class="nf">rule_I_IN_lim</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span>
                <span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">K_S_IN</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;S_IN&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">mw_n</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">I_IN_lim</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Expression</span><span class="p">(</span>
            <span class="n">rule</span><span class="o">=</span><span class="n">rule_I_IN_lim</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Inhibition function related to secondary substrate; inhibit uptake when inorganic nitrogen S_IN~ 0&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">def</span> <span class="nf">rule_I_IP_lim</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span>
                <span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">K_S_IP</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;S_IP&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">mw_p</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">I_IP_lim</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Expression</span><span class="p">(</span>
            <span class="n">rule</span><span class="o">=</span><span class="n">rule_I_IP_lim</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Inhibition function related to secondary substrate; inhibit uptake when inorganic phosphorus S_IP~ 0&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">def</span> <span class="nf">rule_I_h2_fa</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;S_h2&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">K_I_h2_fa</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">I_h2_fa</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Expression</span><span class="p">(</span>
            <span class="n">rule</span><span class="o">=</span><span class="n">rule_I_h2_fa</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;hydrogen inhibition attributed to long chain fatty acids&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">def</span> <span class="nf">rule_I_h2_c4</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;S_h2&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">K_I_h2_c4</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">I_h2_c4</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Expression</span><span class="p">(</span>
            <span class="n">rule</span><span class="o">=</span><span class="n">rule_I_h2_c4</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;hydrogen inhibition attributed to valerate and butyrate uptake&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">def</span> <span class="nf">rule_I_h2_pro</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;S_h2&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">K_I_h2_pro</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">I_h2_pro</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Expression</span><span class="p">(</span>
            <span class="n">rule</span><span class="o">=</span><span class="n">rule_I_h2_pro</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;hydrogen inhibition attributed to propionate uptake&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># TODO: revisit Z_h2s value if we have ref state for S_h2s (currently assumed to be 0)</span>
        <span class="k">def</span> <span class="nf">rule_I_h2s_ac</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">Z_h2s</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">K_I_h2s_ac</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">I_h2s_ac</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Expression</span><span class="p">(</span>
            <span class="n">rule</span><span class="o">=</span><span class="n">rule_I_h2s_ac</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;hydrogen sulfide inhibition attributed to acetate uptake&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">def</span> <span class="nf">rule_I_h2s_c4</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">Z_h2s</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">K_I_h2s_c4</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">I_h2s_c4</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Expression</span><span class="p">(</span>
            <span class="n">rule</span><span class="o">=</span><span class="n">rule_I_h2s_c4</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;hydrogen sulfide inhibition attributed to valerate and butyrate uptake&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">def</span> <span class="nf">rule_I_h2s_h2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">Z_h2s</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">K_I_h2s_h2</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">I_h2s_h2</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Expression</span><span class="p">(</span>
            <span class="n">rule</span><span class="o">=</span><span class="n">rule_I_h2s_h2</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;hydrogen sulfide inhibition attributed to hydrogen uptake&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">def</span> <span class="nf">rule_I_h2s_pro</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">Z_h2s</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">K_I_h2s_pro</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">I_h2s_pro</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Expression</span><span class="p">(</span>
            <span class="n">rule</span><span class="o">=</span><span class="n">rule_I_h2s_pro</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;hydrogen sulfide inhibition attributed to propionate uptake&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">def</span> <span class="nf">rule_I_nh3</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">conc_mol_nh3</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">K_I_nh3</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">I_nh3</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Expression</span><span class="p">(</span>
            <span class="n">rule</span><span class="o">=</span><span class="n">rule_I_nh3</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;ammonia inibition attributed to acetate uptake&quot;</span>
        <span class="p">)</span>

        <span class="k">def</span> <span class="nf">rule_I_pH_aa</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="o">-</span><span class="mi">3</span>
                <span class="o">*</span> <span class="p">(</span>
                    <span class="n">smooth_max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">pH_UL_aa</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">pH</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">)</span>
                    <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">pH_UL_aa</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">pH_LL_aa</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="o">**</span> <span class="mi">2</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">I_pH_aa</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Expression</span><span class="p">(</span>
            <span class="n">rule</span><span class="o">=</span><span class="n">rule_I_pH_aa</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;pH inhibition of amino-acid-utilizing microorganisms&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">def</span> <span class="nf">rule_I_pH_ac</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="o">-</span><span class="mi">3</span>
                <span class="o">*</span> <span class="p">(</span>
                    <span class="n">smooth_max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">pH_UL_ac</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">pH</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">)</span>
                    <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">pH_UL_ac</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">pH_LL_ac</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="o">**</span> <span class="mi">2</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">I_pH_ac</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Expression</span><span class="p">(</span>
            <span class="n">rule</span><span class="o">=</span><span class="n">rule_I_pH_ac</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;pH inhibition of acetate-utilizing microorganisms&quot;</span>
        <span class="p">)</span>

        <span class="k">def</span> <span class="nf">rule_I_pH_h2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="o">-</span><span class="mi">3</span>
                <span class="o">*</span> <span class="p">(</span>
                    <span class="n">smooth_max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">pH_UL_h2</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">pH</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">)</span>
                    <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">pH_UL_h2</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">pH_LL_h2</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="o">**</span> <span class="mi">2</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">I_pH_h2</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Expression</span><span class="p">(</span>
            <span class="n">rule</span><span class="o">=</span><span class="n">rule_I_pH_h2</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;pH inhibition of hydrogen-utilizing microorganisms&quot;</span>
        <span class="p">)</span>

        <span class="k">def</span> <span class="nf">rule_I</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">r</span> <span class="o">==</span> <span class="s2">&quot;R4&quot;</span> <span class="ow">or</span> <span class="n">r</span> <span class="o">==</span> <span class="s2">&quot;R5&quot;</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">I</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">==</span> <span class="n">pyo</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">I_pH_aa</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">I_IN_lim</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">I_IP_lim</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="n">r</span> <span class="o">==</span> <span class="s2">&quot;R6&quot;</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">I</span><span class="p">[</span><span class="n">r</span><span class="p">]</span>
                    <span class="o">==</span> <span class="n">pyo</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">I_pH_aa</span><span class="p">)</span>
                    <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">I_IN_lim</span>
                    <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">I_h2_fa</span>
                    <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">I_IP_lim</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="n">r</span> <span class="o">==</span> <span class="s2">&quot;R7&quot;</span> <span class="ow">or</span> <span class="n">r</span> <span class="o">==</span> <span class="s2">&quot;R8&quot;</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">I</span><span class="p">[</span><span class="n">r</span><span class="p">]</span>
                    <span class="o">==</span> <span class="n">pyo</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">I_pH_aa</span><span class="p">)</span>
                    <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">I_IN_lim</span>
                    <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">I_h2_c4</span>
                    <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">I_IP_lim</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="n">r</span> <span class="o">==</span> <span class="s2">&quot;R9&quot;</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">I</span><span class="p">[</span><span class="n">r</span><span class="p">]</span>
                    <span class="o">==</span> <span class="n">pyo</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">I_pH_aa</span><span class="p">)</span>
                    <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">I_IN_lim</span>
                    <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">I_h2_pro</span>
                    <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">I_IP_lim</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="n">r</span> <span class="o">==</span> <span class="s2">&quot;R10&quot;</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">I</span><span class="p">[</span><span class="n">r</span><span class="p">]</span>
                    <span class="o">==</span> <span class="n">pyo</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">I_pH_ac</span><span class="p">)</span>
                    <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">I_IN_lim</span>
                    <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">I_nh3</span>
                    <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">I_IP_lim</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="n">r</span> <span class="o">==</span> <span class="s2">&quot;R11&quot;</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">I</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">==</span> <span class="n">pyo</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">I_pH_h2</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">I_IN_lim</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">I_IP_lim</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">I</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">==</span> <span class="mf">1.0</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">I_fun</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">rate_reaction_idx</span><span class="p">,</span>
            <span class="n">rule</span><span class="o">=</span><span class="n">rule_I</span><span class="p">,</span>
            <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Process inhibition functions&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>

            <span class="k">def</span> <span class="nf">rate_expression_rule</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">r</span> <span class="o">==</span> <span class="s2">&quot;R1&quot;</span><span class="p">:</span>
                    <span class="c1"># R1: Hydrolysis of carbohydrates</span>
                    <span class="k">return</span> <span class="n">b</span><span class="o">.</span><span class="n">reaction_rate</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">==</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span>
                        <span class="n">b</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">k_hyd_ch</span> <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;X_ch&quot;</span><span class="p">],</span>
                        <span class="n">to_units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">s</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="k">elif</span> <span class="n">r</span> <span class="o">==</span> <span class="s2">&quot;R2&quot;</span><span class="p">:</span>
                    <span class="c1"># R2: Hydrolysis of proteins</span>
                    <span class="k">return</span> <span class="n">b</span><span class="o">.</span><span class="n">reaction_rate</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">==</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span>
                        <span class="n">b</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">k_hyd_pr</span> <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;X_pr&quot;</span><span class="p">],</span>
                        <span class="n">to_units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">s</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="k">elif</span> <span class="n">r</span> <span class="o">==</span> <span class="s2">&quot;R3&quot;</span><span class="p">:</span>
                    <span class="c1"># R3: Hydrolysis of lipids</span>
                    <span class="k">return</span> <span class="n">b</span><span class="o">.</span><span class="n">reaction_rate</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">==</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span>
                        <span class="n">b</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">k_hyd_li</span> <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;X_li&quot;</span><span class="p">],</span>
                        <span class="n">to_units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">s</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="k">elif</span> <span class="n">r</span> <span class="o">==</span> <span class="s2">&quot;R4&quot;</span><span class="p">:</span>
                    <span class="c1"># R4: Uptake of sugars</span>
                    <span class="k">return</span> <span class="n">b</span><span class="o">.</span><span class="n">reaction_rate</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">==</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span>
                        <span class="n">b</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">k_m_su</span>
                        <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;S_su&quot;</span><span class="p">]</span>
                        <span class="o">/</span> <span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">K_S_su</span> <span class="o">+</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;S_su&quot;</span><span class="p">])</span>
                        <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;X_su&quot;</span><span class="p">]</span>
                        <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">I</span><span class="p">[</span><span class="n">r</span><span class="p">],</span>
                        <span class="n">to_units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">s</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="k">elif</span> <span class="n">r</span> <span class="o">==</span> <span class="s2">&quot;R5&quot;</span><span class="p">:</span>
                    <span class="c1"># R5: Uptake of amino acids</span>
                    <span class="k">return</span> <span class="n">b</span><span class="o">.</span><span class="n">reaction_rate</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">==</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span>
                        <span class="n">b</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">k_m_aa</span>
                        <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;S_aa&quot;</span><span class="p">]</span>
                        <span class="o">/</span> <span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">K_S_aa</span> <span class="o">+</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;S_aa&quot;</span><span class="p">])</span>
                        <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;X_aa&quot;</span><span class="p">]</span>
                        <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">I</span><span class="p">[</span><span class="n">r</span><span class="p">],</span>
                        <span class="n">to_units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">s</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="k">elif</span> <span class="n">r</span> <span class="o">==</span> <span class="s2">&quot;R6&quot;</span><span class="p">:</span>
                    <span class="c1"># R6: Uptake of long chain fatty acids (LCFAs)</span>
                    <span class="k">return</span> <span class="n">b</span><span class="o">.</span><span class="n">reaction_rate</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">==</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span>
                        <span class="n">b</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">k_m_fa</span>
                        <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;S_fa&quot;</span><span class="p">]</span>
                        <span class="o">/</span> <span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">K_S_fa</span> <span class="o">+</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;S_fa&quot;</span><span class="p">])</span>
                        <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;X_fa&quot;</span><span class="p">]</span>
                        <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">I</span><span class="p">[</span><span class="n">r</span><span class="p">],</span>
                        <span class="n">to_units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">s</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="k">elif</span> <span class="n">r</span> <span class="o">==</span> <span class="s2">&quot;R7&quot;</span><span class="p">:</span>
                    <span class="c1"># R7: Uptake of valerate</span>
                    <span class="k">return</span> <span class="n">b</span><span class="o">.</span><span class="n">reaction_rate</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">==</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span>
                        <span class="n">b</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">k_m_c4</span>
                        <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;S_va&quot;</span><span class="p">]</span>
                        <span class="o">/</span> <span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">K_S_c4</span> <span class="o">+</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;S_va&quot;</span><span class="p">])</span>
                        <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;X_c4&quot;</span><span class="p">]</span>
                        <span class="o">*</span> <span class="p">(</span>
                            <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;S_va&quot;</span><span class="p">]</span>
                            <span class="o">/</span> <span class="p">(</span>
                                <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;S_va&quot;</span><span class="p">]</span>
                                <span class="o">+</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;S_bu&quot;</span><span class="p">]</span>
                                <span class="o">+</span> <span class="mf">1e-10</span> <span class="o">*</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span>
                            <span class="p">)</span>
                        <span class="p">)</span>
                        <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">I</span><span class="p">[</span><span class="n">r</span><span class="p">]</span>
                        <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">I_h2s_c4</span><span class="p">,</span>
                        <span class="n">to_units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">s</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="k">elif</span> <span class="n">r</span> <span class="o">==</span> <span class="s2">&quot;R8&quot;</span><span class="p">:</span>
                    <span class="c1"># R8:  Uptake of butyrate</span>
                    <span class="k">return</span> <span class="n">b</span><span class="o">.</span><span class="n">reaction_rate</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">==</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span>
                        <span class="n">b</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">k_m_c4</span>
                        <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;S_bu&quot;</span><span class="p">]</span>
                        <span class="o">/</span> <span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">K_S_c4</span> <span class="o">+</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;S_bu&quot;</span><span class="p">])</span>
                        <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;X_c4&quot;</span><span class="p">]</span>
                        <span class="o">*</span> <span class="p">(</span>
                            <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;S_bu&quot;</span><span class="p">]</span>
                            <span class="o">/</span> <span class="p">(</span>
                                <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;S_va&quot;</span><span class="p">]</span>
                                <span class="o">+</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;S_bu&quot;</span><span class="p">]</span>
                                <span class="o">+</span> <span class="mf">1e-10</span> <span class="o">*</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span>
                            <span class="p">)</span>
                        <span class="p">)</span>
                        <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">I</span><span class="p">[</span><span class="n">r</span><span class="p">]</span>
                        <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">I_h2s_c4</span><span class="p">,</span>
                        <span class="n">to_units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">s</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="k">elif</span> <span class="n">r</span> <span class="o">==</span> <span class="s2">&quot;R9&quot;</span><span class="p">:</span>
                    <span class="c1"># R9: Uptake of propionate</span>
                    <span class="k">return</span> <span class="n">b</span><span class="o">.</span><span class="n">reaction_rate</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">==</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span>
                        <span class="n">b</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">k_m_pro</span>
                        <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;S_pro&quot;</span><span class="p">]</span>
                        <span class="o">/</span> <span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">K_S_pro</span> <span class="o">+</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;S_pro&quot;</span><span class="p">])</span>
                        <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;X_pro&quot;</span><span class="p">]</span>
                        <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">I</span><span class="p">[</span><span class="n">r</span><span class="p">]</span>
                        <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">I_h2s_pro</span><span class="p">,</span>
                        <span class="n">to_units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">s</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="k">elif</span> <span class="n">r</span> <span class="o">==</span> <span class="s2">&quot;R10&quot;</span><span class="p">:</span>
                    <span class="c1"># R10: Uptake of acetate</span>
                    <span class="k">return</span> <span class="n">b</span><span class="o">.</span><span class="n">reaction_rate</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">==</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span>
                        <span class="n">b</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">k_m_ac</span>
                        <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;S_ac&quot;</span><span class="p">]</span>
                        <span class="o">/</span> <span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">K_S_ac</span> <span class="o">+</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;S_ac&quot;</span><span class="p">])</span>
                        <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;X_ac&quot;</span><span class="p">]</span>
                        <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">I</span><span class="p">[</span><span class="n">r</span><span class="p">]</span>
                        <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">I_h2s_ac</span><span class="p">,</span>
                        <span class="n">to_units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">s</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="k">elif</span> <span class="n">r</span> <span class="o">==</span> <span class="s2">&quot;R11&quot;</span><span class="p">:</span>
                    <span class="c1"># R11: Uptake of hydrogen</span>
                    <span class="k">return</span> <span class="n">b</span><span class="o">.</span><span class="n">reaction_rate</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">==</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span>
                        <span class="n">b</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">k_m_h2</span>
                        <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;S_h2&quot;</span><span class="p">]</span>
                        <span class="o">/</span> <span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">K_S_h2</span> <span class="o">+</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;S_h2&quot;</span><span class="p">])</span>
                        <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;X_h2&quot;</span><span class="p">]</span>
                        <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">I</span><span class="p">[</span><span class="n">r</span><span class="p">]</span>
                        <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">I_h2s_h2</span><span class="p">,</span>
                        <span class="n">to_units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">s</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="k">elif</span> <span class="n">r</span> <span class="o">==</span> <span class="s2">&quot;R12&quot;</span><span class="p">:</span>
                    <span class="c1"># R12: Decay of X_su</span>
                    <span class="k">return</span> <span class="n">b</span><span class="o">.</span><span class="n">reaction_rate</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">==</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span>
                        <span class="n">b</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">k_dec_X_su</span> <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;X_su&quot;</span><span class="p">],</span>
                        <span class="n">to_units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">s</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="k">elif</span> <span class="n">r</span> <span class="o">==</span> <span class="s2">&quot;R13&quot;</span><span class="p">:</span>
                    <span class="c1"># R13: Decay of X_aa</span>
                    <span class="k">return</span> <span class="n">b</span><span class="o">.</span><span class="n">reaction_rate</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">==</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span>
                        <span class="n">b</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">k_dec_X_aa</span> <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;X_aa&quot;</span><span class="p">],</span>
                        <span class="n">to_units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">s</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="k">elif</span> <span class="n">r</span> <span class="o">==</span> <span class="s2">&quot;R14&quot;</span><span class="p">:</span>
                    <span class="c1"># R14: Decay of X_fa</span>
                    <span class="k">return</span> <span class="n">b</span><span class="o">.</span><span class="n">reaction_rate</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">==</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span>
                        <span class="n">b</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">k_dec_X_fa</span> <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;X_fa&quot;</span><span class="p">],</span>
                        <span class="n">to_units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">s</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="k">elif</span> <span class="n">r</span> <span class="o">==</span> <span class="s2">&quot;R15&quot;</span><span class="p">:</span>
                    <span class="c1"># R15: Decay of X_c4</span>
                    <span class="k">return</span> <span class="n">b</span><span class="o">.</span><span class="n">reaction_rate</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">==</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span>
                        <span class="n">b</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">k_dec_X_c4</span> <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;X_c4&quot;</span><span class="p">],</span>
                        <span class="n">to_units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">s</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="k">elif</span> <span class="n">r</span> <span class="o">==</span> <span class="s2">&quot;R16&quot;</span><span class="p">:</span>
                    <span class="c1"># R16: Decay of X_pro</span>
                    <span class="k">return</span> <span class="n">b</span><span class="o">.</span><span class="n">reaction_rate</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">==</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span>
                        <span class="n">b</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">k_dec_X_pro</span> <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;X_pro&quot;</span><span class="p">],</span>
                        <span class="n">to_units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">s</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="k">elif</span> <span class="n">r</span> <span class="o">==</span> <span class="s2">&quot;R17&quot;</span><span class="p">:</span>
                    <span class="c1"># R17: Decay of X_ac</span>
                    <span class="k">return</span> <span class="n">b</span><span class="o">.</span><span class="n">reaction_rate</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">==</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span>
                        <span class="n">b</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">k_dec_X_ac</span> <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;X_ac&quot;</span><span class="p">],</span>
                        <span class="n">to_units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">s</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="k">elif</span> <span class="n">r</span> <span class="o">==</span> <span class="s2">&quot;R18&quot;</span><span class="p">:</span>
                    <span class="c1"># R18: Decay of X_h2</span>
                    <span class="k">return</span> <span class="n">b</span><span class="o">.</span><span class="n">reaction_rate</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">==</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span>
                        <span class="n">b</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">k_dec_X_h2</span> <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;X_h2&quot;</span><span class="p">],</span>
                        <span class="n">to_units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">s</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="k">elif</span> <span class="n">r</span> <span class="o">==</span> <span class="s2">&quot;R19&quot;</span><span class="p">:</span>
                    <span class="c1"># R19: Storage of S_va in X_PHA</span>
                    <span class="k">return</span> <span class="n">b</span><span class="o">.</span><span class="n">reaction_rate</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">==</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span>
                        <span class="n">b</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">q_PHA</span>
                        <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;S_va&quot;</span><span class="p">]</span>
                        <span class="o">/</span> <span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">K_A</span> <span class="o">+</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;S_va&quot;</span><span class="p">])</span>
                        <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;X_PP&quot;</span><span class="p">]</span>
                        <span class="o">/</span> <span class="p">(</span>
                            <span class="n">b</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">K_PP</span> <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;X_PAO&quot;</span><span class="p">]</span>
                            <span class="o">+</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;X_PP&quot;</span><span class="p">]</span>
                        <span class="p">)</span>
                        <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;X_PAO&quot;</span><span class="p">]</span>
                        <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;S_va&quot;</span><span class="p">]</span>
                        <span class="o">/</span> <span class="p">(</span>
                            <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;S_va&quot;</span><span class="p">]</span>
                            <span class="o">+</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;S_bu&quot;</span><span class="p">]</span>
                            <span class="o">+</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;S_pro&quot;</span><span class="p">]</span>
                            <span class="o">+</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;S_ac&quot;</span><span class="p">]</span>
                            <span class="o">+</span> <span class="mf">1e-10</span> <span class="o">*</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span>
                        <span class="p">),</span>
                        <span class="n">to_units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">s</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="k">elif</span> <span class="n">r</span> <span class="o">==</span> <span class="s2">&quot;R20&quot;</span><span class="p">:</span>
                    <span class="c1"># R20: Storage of S_bu in X_PHA</span>
                    <span class="k">return</span> <span class="n">b</span><span class="o">.</span><span class="n">reaction_rate</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">==</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span>
                        <span class="n">b</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">q_PHA</span>
                        <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;S_bu&quot;</span><span class="p">]</span>
                        <span class="o">/</span> <span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">K_A</span> <span class="o">+</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;S_bu&quot;</span><span class="p">])</span>
                        <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;X_PP&quot;</span><span class="p">]</span>
                        <span class="o">/</span> <span class="p">(</span>
                            <span class="n">b</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">K_PP</span> <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;X_PAO&quot;</span><span class="p">]</span>
                            <span class="o">+</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;X_PP&quot;</span><span class="p">]</span>
                        <span class="p">)</span>
                        <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;X_PAO&quot;</span><span class="p">]</span>
                        <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;S_bu&quot;</span><span class="p">]</span>
                        <span class="o">/</span> <span class="p">(</span>
                            <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;S_va&quot;</span><span class="p">]</span>
                            <span class="o">+</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;S_bu&quot;</span><span class="p">]</span>
                            <span class="o">+</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;S_pro&quot;</span><span class="p">]</span>
                            <span class="o">+</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;S_ac&quot;</span><span class="p">]</span>
                            <span class="o">+</span> <span class="mf">1e-10</span> <span class="o">*</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span>
                        <span class="p">),</span>
                        <span class="n">to_units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">s</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="k">elif</span> <span class="n">r</span> <span class="o">==</span> <span class="s2">&quot;R21&quot;</span><span class="p">:</span>
                    <span class="c1"># R21: Storage of S_pro in X_PHA</span>
                    <span class="k">return</span> <span class="n">b</span><span class="o">.</span><span class="n">reaction_rate</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">==</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span>
                        <span class="n">b</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">q_PHA</span>
                        <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;S_pro&quot;</span><span class="p">]</span>
                        <span class="o">/</span> <span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">K_A</span> <span class="o">+</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;S_pro&quot;</span><span class="p">])</span>
                        <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;X_PP&quot;</span><span class="p">]</span>
                        <span class="o">/</span> <span class="p">(</span>
                            <span class="n">b</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">K_PP</span> <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;X_PAO&quot;</span><span class="p">]</span>
                            <span class="o">+</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;X_PP&quot;</span><span class="p">]</span>
                        <span class="p">)</span>
                        <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;X_PAO&quot;</span><span class="p">]</span>
                        <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;S_pro&quot;</span><span class="p">]</span>
                        <span class="o">/</span> <span class="p">(</span>
                            <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;S_va&quot;</span><span class="p">]</span>
                            <span class="o">+</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;S_bu&quot;</span><span class="p">]</span>
                            <span class="o">+</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;S_pro&quot;</span><span class="p">]</span>
                            <span class="o">+</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;S_ac&quot;</span><span class="p">]</span>
                            <span class="o">+</span> <span class="mf">1e-10</span> <span class="o">*</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span>
                        <span class="p">),</span>
                        <span class="n">to_units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">s</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="k">elif</span> <span class="n">r</span> <span class="o">==</span> <span class="s2">&quot;R22&quot;</span><span class="p">:</span>
                    <span class="c1"># R22: Storage of S_ac in X_PHA</span>
                    <span class="k">return</span> <span class="n">b</span><span class="o">.</span><span class="n">reaction_rate</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">==</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span>
                        <span class="n">b</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">q_PHA</span>
                        <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;S_ac&quot;</span><span class="p">]</span>
                        <span class="o">/</span> <span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">K_A</span> <span class="o">+</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;S_ac&quot;</span><span class="p">])</span>
                        <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;X_PP&quot;</span><span class="p">]</span>
                        <span class="o">/</span> <span class="p">(</span>
                            <span class="n">b</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">K_PP</span> <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;X_PAO&quot;</span><span class="p">]</span>
                            <span class="o">+</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;X_PP&quot;</span><span class="p">]</span>
                        <span class="p">)</span>
                        <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;X_PAO&quot;</span><span class="p">]</span>
                        <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;S_ac&quot;</span><span class="p">]</span>
                        <span class="o">/</span> <span class="p">(</span>
                            <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;S_va&quot;</span><span class="p">]</span>
                            <span class="o">+</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;S_bu&quot;</span><span class="p">]</span>
                            <span class="o">+</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;S_pro&quot;</span><span class="p">]</span>
                            <span class="o">+</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;S_ac&quot;</span><span class="p">]</span>
                            <span class="o">+</span> <span class="mf">1e-10</span> <span class="o">*</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span>
                        <span class="p">),</span>
                        <span class="n">to_units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">s</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="k">elif</span> <span class="n">r</span> <span class="o">==</span> <span class="s2">&quot;R23&quot;</span><span class="p">:</span>
                    <span class="c1"># R23: Lysis of X_PAO</span>
                    <span class="k">return</span> <span class="n">b</span><span class="o">.</span><span class="n">reaction_rate</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">==</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span>
                        <span class="n">b</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">b_PAO</span> <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;X_PAO&quot;</span><span class="p">],</span>
                        <span class="n">to_units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">s</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="k">elif</span> <span class="n">r</span> <span class="o">==</span> <span class="s2">&quot;R24&quot;</span><span class="p">:</span>
                    <span class="c1"># R24: Lysis of X_PP</span>
                    <span class="k">return</span> <span class="n">b</span><span class="o">.</span><span class="n">reaction_rate</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">==</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span>
                        <span class="n">b</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">b_PP</span> <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;X_PP&quot;</span><span class="p">],</span>
                        <span class="n">to_units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">s</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="k">elif</span> <span class="n">r</span> <span class="o">==</span> <span class="s2">&quot;R25&quot;</span><span class="p">:</span>
                    <span class="c1"># R25: Lysis of X_PHA</span>
                    <span class="k">return</span> <span class="n">b</span><span class="o">.</span><span class="n">reaction_rate</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">==</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span>
                        <span class="n">b</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">b_PHA</span> <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">conc_mass_comp_ref</span><span class="p">[</span><span class="s2">&quot;X_PHA&quot;</span><span class="p">],</span>
                        <span class="n">to_units</span><span class="o">=</span><span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span> <span class="o">/</span> <span class="n">pyo</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">s</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">BurntToast</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">rate_expression</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">rate_reaction_idx</span><span class="p">,</span>
                <span class="n">rule</span><span class="o">=</span><span class="n">rate_expression_rule</span><span class="p">,</span>
                <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;ADM1 rate expressions&quot;</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="c1"># If constraint fails, clean up so that DAE can try again later</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">del_component</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reaction_rate</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">del_component</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rate_expression</span><span class="p">)</span>
            <span class="k">raise</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rates</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">iscale</span><span class="o">.</span><span class="n">set_scaling_factor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reaction_rate</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">c</span><span class="p">)</span>

        <span class="n">iscale</span><span class="o">.</span><span class="n">set_scaling_factor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">I</span><span class="p">,</span> <span class="mf">1e1</span><span class="p">)</span>
        <span class="n">iscale</span><span class="o">.</span><span class="n">set_scaling_factor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conc_mass_va</span><span class="p">,</span> <span class="mf">1e2</span><span class="p">)</span>
        <span class="n">iscale</span><span class="o">.</span><span class="n">set_scaling_factor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conc_mass_bu</span><span class="p">,</span> <span class="mf">1e2</span><span class="p">)</span>
        <span class="n">iscale</span><span class="o">.</span><span class="n">set_scaling_factor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conc_mass_pro</span><span class="p">,</span> <span class="mf">1e2</span><span class="p">)</span>
        <span class="n">iscale</span><span class="o">.</span><span class="n">set_scaling_factor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conc_mass_ac</span><span class="p">,</span> <span class="mf">1e1</span><span class="p">)</span>
        <span class="n">iscale</span><span class="o">.</span><span class="n">set_scaling_factor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conc_mol_hco3</span><span class="p">,</span> <span class="mf">1e1</span><span class="p">)</span>
        <span class="n">iscale</span><span class="o">.</span><span class="n">set_scaling_factor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conc_mol_nh3</span><span class="p">,</span> <span class="mf">1e3</span><span class="p">)</span>
        <span class="n">iscale</span><span class="o">.</span><span class="n">set_scaling_factor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conc_mol_co2</span><span class="p">,</span> <span class="mf">1e3</span><span class="p">)</span>
        <span class="n">iscale</span><span class="o">.</span><span class="n">set_scaling_factor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conc_mol_nh4</span><span class="p">,</span> <span class="mf">1e1</span><span class="p">)</span>
        <span class="n">iscale</span><span class="o">.</span><span class="n">set_scaling_factor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conc_mol_Mg</span><span class="p">,</span> <span class="mf">1e3</span><span class="p">)</span>
        <span class="n">iscale</span><span class="o">.</span><span class="n">set_scaling_factor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conc_mol_K</span><span class="p">,</span> <span class="mf">1e3</span><span class="p">)</span>
        <span class="n">iscale</span><span class="o">.</span><span class="n">set_scaling_factor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">S_H</span><span class="p">,</span> <span class="mf">1e5</span><span class="p">)</span>
        <span class="n">iscale</span><span class="o">.</span><span class="n">set_scaling_factor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pKW</span><span class="p">,</span> <span class="mf">1e0</span><span class="p">)</span>
        <span class="n">iscale</span><span class="o">.</span><span class="n">set_scaling_factor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pK_a_co2</span><span class="p">,</span> <span class="mf">1e0</span><span class="p">)</span>
        <span class="n">iscale</span><span class="o">.</span><span class="n">set_scaling_factor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pK_a_IN</span><span class="p">,</span> <span class="mf">1e0</span><span class="p">)</span>
        <span class="n">iscale</span><span class="o">.</span><span class="n">set_scaling_factor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pH</span><span class="p">,</span> <span class="mf">1e0</span><span class="p">)</span>

<div class="viewcode-block" id="ModifiedADM1ReactionBlockData.get_reaction_rate_basis"><a class="viewcode-back" href="../../../../../technical_reference/property_models/modified_ADM1.html#watertap.property_models.unit_specific.anaerobic_digestion.modified_adm1_reactions.ModifiedADM1ReactionBlockData.get_reaction_rate_basis">[docs]</a>    <span class="k">def</span> <span class="nf">get_reaction_rate_basis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">MaterialFlowBasis</span><span class="o">.</span><span class="n">mass</span></div>

    <span class="k">def</span> <span class="nf">calculate_scaling_factors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">calculate_scaling_factors</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rate_expression</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">iscale</span><span class="o">.</span><span class="n">constraint_scaling_transform</span><span class="p">(</span>
                <span class="n">c</span><span class="p">,</span>
                <span class="n">iscale</span><span class="o">.</span><span class="n">get_scaling_factor</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">reaction_rate</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">default</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">warning</span><span class="o">=</span><span class="kc">True</span>
                <span class="p">),</span>
                <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; <a href="../../../../../copyright.html">Copyright</a> 2020-2024, NAWI.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>